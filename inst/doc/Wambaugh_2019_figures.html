<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="John F. Wambaugh" />

<meta name="date" content="2019-09-09" />

<title>Wambaugh et al. (submitted): Creating Figures for the Manuscript</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Wambaugh et al. (submitted): Creating Figures for the Manuscript</h1>
<h4 class="author"><em>John F. Wambaugh</em></h4>
<h4 class="date"><em>2019-09-09</em></h4>



<p>#Wambaugh et al. (submitted): Creating Figures for the Manuscript ##Prepate for session</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(httk)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(gdata)</a></code></pre></div>
<pre><code>## gdata: read.xls support for &#39;XLS&#39; (Excel 97-2004) files ENABLED.</code></pre>
<pre><code>## </code></pre>
<pre><code>## gdata: read.xls support for &#39;XLSX&#39; (Excel 2007+) files ENABLED.</code></pre>
<pre><code>## 
## Attaching package: &#39;gdata&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     first, last</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     nobs</code></pre>
<pre><code>## The following object is masked from &#39;package:utils&#39;:
## 
##     object.size</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     startsWith</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">library</span>(reshape)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;reshape&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:data.table&#39;:
## 
##     melt</code></pre>
<div id="define-some-needed-code" class="section level2">
<h2>Define some needed code:</h2>
<div id="rmse-and-r2" class="section level3">
<h3>RMSE and R^2</h3>
<p>This returns an expression with RMSE and R^2 for plotting:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">lm_R2 &lt;-<span class="st"> </span><span class="cf">function</span>(m,<span class="dt">prefix=</span><span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb13-2" title="2">    out &lt;-<span class="st"> </span><span class="kw">substitute</span>(<span class="st">&quot;RMSE = &quot;</span><span class="op">~</span>mse<span class="op">*</span><span class="st">&quot;,&quot;</span><span class="op">~</span><span class="er">~</span><span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span><span class="op">~</span><span class="st">&quot;=&quot;</span><span class="op">~</span>r2, </a>
<a class="sourceLine" id="cb13-3" title="3">         <span class="kw">list</span>(<span class="dt">mse =</span> <span class="kw">signif</span>(<span class="kw">mean</span>(m<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>),<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb13-4" title="4">              <span class="dt">r2 =</span> <span class="kw">format</span>(<span class="kw">summary</span>(m)<span class="op">$</span>adj.r.squared, <span class="dt">digits =</span> <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb13-5" title="5">    <span class="kw">paste</span>(prefix,<span class="kw">as.character</span>(<span class="kw">as.expression</span>(out)))                 </a>
<a class="sourceLine" id="cb13-6" title="6">}</a></code></pre></div>
</div>
<div id="multiple-plot-function" class="section level3">
<h3>Multiple plot function</h3>
<p>From <a href="http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/" class="uri">http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/</a> ggplot objects can be passed in …, or to plotlist (as a list of ggplot objects) - cols: Number of columns in layout - layout: A matrix specifying the layout. If present, ‘cols’ is ignored.</p>
<p>If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE), then plot 1 will go in the upper left, 2 will go in the upper right, and 3 will go all the way across the bottom.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">multiplot &lt;-<span class="st"> </span><span class="cf">function</span>(..., <span class="dt">plotlist=</span><span class="ot">NULL</span>, file, <span class="dt">cols=</span><span class="dv">1</span>, <span class="dt">layout=</span><span class="ot">NULL</span>, <span class="dt">heights=</span><span class="ot">NULL</span>, <span class="dt">widths=</span><span class="kw">unit</span>(<span class="kw">rep_len</span>(<span class="dv">1</span>, cols), <span class="st">&quot;null&quot;</span>)) {</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="co"># Make a list from the ... arguments and plotlist</span></a>
<a class="sourceLine" id="cb14-4" title="4">  plots &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">list</span>(...), plotlist)</a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6">  numPlots =<span class="st"> </span><span class="kw">length</span>(plots)</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="co"># If layout is NULL, then use &#39;cols&#39; to determine layout</span></a>
<a class="sourceLine" id="cb14-9" title="9">  <span class="cf">if</span> (<span class="kw">is.null</span>(layout)) {</a>
<a class="sourceLine" id="cb14-10" title="10">    <span class="co"># Make the panel</span></a>
<a class="sourceLine" id="cb14-11" title="11">    <span class="co"># ncol: Number of columns of plots</span></a>
<a class="sourceLine" id="cb14-12" title="12">    <span class="co"># nrow: Number of rows needed, calculated from # of cols</span></a>
<a class="sourceLine" id="cb14-13" title="13">    layout &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">seq</span>(<span class="dv">1</span>, cols <span class="op">*</span><span class="st"> </span><span class="kw">ceiling</span>(numPlots<span class="op">/</span>cols)),</a>
<a class="sourceLine" id="cb14-14" title="14">                    <span class="dt">ncol =</span> cols, <span class="dt">nrow =</span> <span class="kw">ceiling</span>(numPlots<span class="op">/</span>cols))</a>
<a class="sourceLine" id="cb14-15" title="15">  }</a>
<a class="sourceLine" id="cb14-16" title="16"></a>
<a class="sourceLine" id="cb14-17" title="17"> <span class="cf">if</span> (numPlots<span class="op">==</span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb14-18" title="18">    <span class="kw">print</span>(plots[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb14-19" title="19"></a>
<a class="sourceLine" id="cb14-20" title="20">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb14-21" title="21">    <span class="co"># Set up the page</span></a>
<a class="sourceLine" id="cb14-22" title="22">    <span class="kw">grid.newpage</span>()</a>
<a class="sourceLine" id="cb14-23" title="23">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(heights))</a>
<a class="sourceLine" id="cb14-24" title="24">    {</a>
<a class="sourceLine" id="cb14-25" title="25">      <span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">layout =</span> <span class="kw">grid.layout</span>(<span class="kw">nrow</span>(layout), <span class="kw">ncol</span>(layout),<span class="dt">heights=</span>heights,<span class="dt">widths=</span>widths)))</a>
<a class="sourceLine" id="cb14-26" title="26">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb14-27" title="27">      <span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">layout =</span> <span class="kw">grid.layout</span>(<span class="kw">nrow</span>(layout), <span class="kw">ncol</span>(layout),<span class="dt">widths=</span>widths)))</a>
<a class="sourceLine" id="cb14-28" title="28">    }</a>
<a class="sourceLine" id="cb14-29" title="29">    <span class="co"># Make each plot, in the correct location</span></a>
<a class="sourceLine" id="cb14-30" title="30">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numPlots) {</a>
<a class="sourceLine" id="cb14-31" title="31">      <span class="co"># Get the i,j matrix positions of the regions that contain this subplot</span></a>
<a class="sourceLine" id="cb14-32" title="32">      matchidx &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">which</span>(layout <span class="op">==</span><span class="st"> </span>i, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb14-33" title="33"></a>
<a class="sourceLine" id="cb14-34" title="34">      <span class="kw">print</span>(plots[[i]], <span class="dt">vp =</span> <span class="kw">viewport</span>(<span class="dt">layout.pos.row =</span> matchidx<span class="op">$</span>row,</a>
<a class="sourceLine" id="cb14-35" title="35">                                      <span class="dt">layout.pos.col =</span> matchidx<span class="op">$</span>col))</a>
<a class="sourceLine" id="cb14-36" title="36">    }</a>
<a class="sourceLine" id="cb14-37" title="37">  }</a>
<a class="sourceLine" id="cb14-38" title="38">}</a></code></pre></div>
</div>
<div id="function-to-format-scientific-notation" class="section level3">
<h3>Function to format scientific notation</h3>
<p>From <a href="https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales" class="uri">https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales</a></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">scientific_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x) {                                  </a>
<a class="sourceLine" id="cb15-2" title="2">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="kw">scientific_format</span>()(x))              </a>
<a class="sourceLine" id="cb15-3" title="3">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </a>
<a class="sourceLine" id="cb15-4" title="4">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </a>
<a class="sourceLine" id="cb15-5" title="5">  out &lt;-<span class="st"> </span><span class="kw">parse</span>(<span class="dt">text=</span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out))                    </a>
<a class="sourceLine" id="cb15-6" title="6">}  </a></code></pre></div>
</div>
<div id="function-to-format-scientific-notation-1" class="section level3">
<h3>Function to format scientific notation</h3>
<p>This one leaves every other tickmark blank:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">scientific_<span class="dv">10</span>_skip &lt;-<span class="st"> </span><span class="cf">function</span>(x) {                                  </a>
<a class="sourceLine" id="cb16-2" title="2">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;1e&quot;</span>, <span class="st">&quot;10^&quot;</span>, <span class="kw">scientific_format</span>()(x))              </a>
<a class="sourceLine" id="cb16-3" title="3">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">+&quot;</span>,<span class="st">&quot;&quot;</span>,out)                                     </a>
<a class="sourceLine" id="cb16-4" title="4">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^01&quot;</span>,<span class="st">&quot;10&quot;</span>,out)                               </a>
<a class="sourceLine" id="cb16-5" title="5">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^00&quot;</span>,<span class="st">&quot;1&quot;</span>,out)</a>
<a class="sourceLine" id="cb16-6" title="6">  out &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;10</span><span class="ch">\\</span><span class="st">^-01&quot;</span>,<span class="ot">NA</span>,out)</a>
<a class="sourceLine" id="cb16-7" title="7">  <span class="kw">return</span>(<span class="kw">parse</span>(<span class="dt">text=</span>out))                   </a>
<a class="sourceLine" id="cb16-8" title="8">} </a></code></pre></div>
</div>
<div id="this-calculates-the-css-using-uncertainty-only" class="section level3">
<h3>This calculates the Css using uncertainty only:</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">cssfun_u &lt;-<span class="st"> </span><span class="cf">function</span>(chemcas, </a>
<a class="sourceLine" id="cb17-2" title="2">                      MW, </a>
<a class="sourceLine" id="cb17-3" title="3">                      hepatic.bioavailability, </a>
<a class="sourceLine" id="cb17-4" title="4">                      <span class="dt">Fgutabs=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-5" title="5">                      <span class="dt">probs=</span><span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb17-6" title="6">                      <span class="dt">minimum.Funbound.plasma=</span><span class="fl">0.0001</span>)</a>
<a class="sourceLine" id="cb17-7" title="7">{</a>
<a class="sourceLine" id="cb17-8" title="8">  <span class="co"># Create a data table with uncertainty only:</span></a>
<a class="sourceLine" id="cb17-9" title="9">  pop_u_httk &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(<span class="kw">parameterize_steadystate</span>(<span class="dt">chem.cas=</span>chemcas,</a>
<a class="sourceLine" id="cb17-10" title="10">    <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-11" title="11">    <span class="dt">minimum.Funbound.plasma=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb17-12" title="12">    </a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="co"># Get the physico-chemical properties:</span></a>
<a class="sourceLine" id="cb17-14" title="14">  params.schmitt &lt;-<span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>chemcas)</a>
<a class="sourceLine" id="cb17-15" title="15">  psd &lt;-<span class="st"> </span>params.schmitt<span class="op">$</span>pKa_Donor</a>
<a class="sourceLine" id="cb17-16" title="16">  psa &lt;-<span class="st"> </span>params.schmitt<span class="op">$</span>pKa_Accept</a>
<a class="sourceLine" id="cb17-17" title="17">  params.schmitt &lt;-<span class="st"> </span>params.schmitt[<span class="kw">regexpr</span>(<span class="st">&quot;pKa&quot;</span>,<span class="kw">names</span>(params.schmitt))<span class="op">==-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb17-18" title="18">  pop_u_httk[,<span class="kw">names</span>(params.schmitt)<span class="op">:</span><span class="er">=</span>params.schmitt]</a>
<a class="sourceLine" id="cb17-19" title="19">  pop_u_httk[,pKa_Donor <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(psd, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>)]</a>
<a class="sourceLine" id="cb17-20" title="20">  pop_u_httk[,pKa_Accept <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(psa, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>)]</a>
<a class="sourceLine" id="cb17-21" title="21">  pop_u_httk &lt;-<span class="st"> </span>pop_u_httk[<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>)]</a>
<a class="sourceLine" id="cb17-22" title="22"></a>
<a class="sourceLine" id="cb17-23" title="23">  <span class="co"># Calculate the distribution coefficient:</span></a>
<a class="sourceLine" id="cb17-24" title="24">  ions &lt;-<span class="st"> </span><span class="kw">calc_ionization</span>(<span class="dt">pH=</span><span class="fl">7.4</span>,<span class="dt">parameters=</span>pop_u_httk)</a>
<a class="sourceLine" id="cb17-25" title="25">  pop_u_httk[,Dow74 <span class="op">:</span><span class="er">=</span><span class="st"> </span>Pow <span class="op">*</span><span class="st"> </span>(ions<span class="op">$</span>fraction_neutral <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="st">    </span><span class="fl">0.001</span> <span class="op">*</span><span class="st"> </span>ions<span class="op">$</span>fraction_charged <span class="op">+</span><span class="st"> </span>ions<span class="op">$</span>fraction_zwitter)]</a>
<a class="sourceLine" id="cb17-27" title="27">  </a>
<a class="sourceLine" id="cb17-28" title="28">  <span class="co"># Parse the Funbound.plasma.dist into quantiles:</span></a>
<a class="sourceLine" id="cb17-29" title="29">  Funbound.plasma.dist &lt;-<span class="st"> </span>pop_u_httk[<span class="dv">1</span>,Funbound.plasma.dist]</a>
<a class="sourceLine" id="cb17-30" title="30">  <span class="cf">if</span> (<span class="kw">nchar</span>(Funbound.plasma.dist) <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="st">    </span><span class="kw">nchar</span>(<span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Funbound.plasma.dist))<span class="op">!=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-32" title="32">  {</a>
<a class="sourceLine" id="cb17-33" title="33">    <span class="kw">stop</span>(<span class="st">&quot;Funbound.plasma distribution should be three values (median,low95th,high95th) separated by commas.&quot;</span>)</a>
<a class="sourceLine" id="cb17-34" title="34">  }</a>
<a class="sourceLine" id="cb17-35" title="35">  temp &lt;-<span class="st"> </span><span class="kw">strsplit</span>(Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb17-36" title="36">  ppb.median &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb17-37" title="37">  ppb.low95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb17-38" title="38">  ppb.high95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb17-39" title="39">  </a>
<a class="sourceLine" id="cb17-40" title="40">  <span class="cf">if</span> (ppb.median<span class="op">&gt;</span>minimum.Funbound.plasma)</a>
<a class="sourceLine" id="cb17-41" title="41">  {</a>
<a class="sourceLine" id="cb17-42" title="42">    <span class="co"># Use optim to estimate alpha and beta for fup such that the median and 95% </span></a>
<a class="sourceLine" id="cb17-43" title="43">    <span class="co"># credible interval approximate the estimate from MCMC:</span></a>
<a class="sourceLine" id="cb17-44" title="44">    ppb.fit &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="dv">2</span>,(<span class="dv">1</span><span class="op">-</span>ppb.median)<span class="op">/</span>ppb.median<span class="op">*</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb17-45" title="45">      <span class="cf">function</span>(x) (<span class="fl">0.95</span><span class="op">-</span><span class="kw">pbeta</span>(ppb.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="op">+</span></a>
<a class="sourceLine" id="cb17-46" title="46"><span class="st">      </span><span class="kw">pbeta</span>(ppb.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span><span class="op">+</span></a>
<a class="sourceLine" id="cb17-47" title="47"><span class="st">      </span>(ppb.median<span class="op">-</span><span class="kw">qbeta</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb17-48" title="48">      <span class="dt">method=</span><span class="st">&quot;BFGS&quot;</span>)</a>
<a class="sourceLine" id="cb17-49" title="49">  <span class="co"># We are drawing new values for the unadjusted Fup:</span></a>
<a class="sourceLine" id="cb17-50" title="50">    pop_u_httk[, unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span><span class="kw">rbeta</span>(<span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb17-51" title="51">      ppb.fit<span class="op">$</span>par[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb17-52" title="52">      ppb.fit<span class="op">$</span>par[<span class="dv">2</span>])]</a>
<a class="sourceLine" id="cb17-53" title="53">  } <span class="cf">else</span> <span class="cf">if</span> (ppb.high95<span class="op">&gt;</span>minimum.Funbound.plasma)</a>
<a class="sourceLine" id="cb17-54" title="54">  {</a>
<a class="sourceLine" id="cb17-55" title="55">    <span class="co"># Assume that since the median is zero but the u95 is not, that there is </span></a>
<a class="sourceLine" id="cb17-56" title="56">    <span class="co"># an exponential distribution:</span></a>
<a class="sourceLine" id="cb17-57" title="57">    <span class="co"># 97.5% of clearance values will be below Funbound.plasma.u95:</span></a>
<a class="sourceLine" id="cb17-58" title="58">    pop_u_httk[,unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span><span class="kw">runif</span>(<span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb17-59" title="59">      minimum.Funbound.plasma,</a>
<a class="sourceLine" id="cb17-60" title="60">      <span class="kw">min</span>(<span class="dv">1</span>,minimum.Funbound.plasma<span class="op">+</span></a>
<a class="sourceLine" id="cb17-61" title="61"><span class="st">      </span><span class="dv">2</span><span class="op">*</span>(ppb.high95<span class="op">-</span>minimum.Funbound.plasma)))]</a>
<a class="sourceLine" id="cb17-62" title="62">    pop_u_httk[<span class="kw">as.logical</span>(<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,.<span class="dv">95</span>)),</a>
<a class="sourceLine" id="cb17-63" title="63">      unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma] </a>
<a class="sourceLine" id="cb17-64" title="64">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb17-65" title="65">    pop_u_httk[, unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma]</a>
<a class="sourceLine" id="cb17-66" title="66">  }</a>
<a class="sourceLine" id="cb17-67" title="67">  </a>
<a class="sourceLine" id="cb17-68" title="68"><span class="co"># then we need to adjust for in vitro binding:</span></a>
<a class="sourceLine" id="cb17-69" title="69">  pop_u_httk[,Flipid<span class="op">:</span><span class="er">=</span><span class="kw">subset</span>(physiology.data,</a>
<a class="sourceLine" id="cb17-70" title="70">    Parameter<span class="op">==</span><span class="st">&#39;Plasma Effective Neutral Lipid Volume Fraction&#39;</span>)[,</a>
<a class="sourceLine" id="cb17-71" title="71">    <span class="kw">which</span>(<span class="kw">colnames</span>(physiology.data) <span class="op">==</span><span class="st"> &#39;Human&#39;</span>)]]</a>
<a class="sourceLine" id="cb17-72" title="72">  pop_u_httk[,Funbound.plasma.adjustment<span class="op">:</span><span class="er">=</span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(Dow74 <span class="op">*</span><span class="st"> </span>Flipid <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-73" title="73"><span class="st">    </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>unadjusted.Funbound.plasma)<span class="op">/</span>unadjusted.Funbound.plasma]</a>
<a class="sourceLine" id="cb17-74" title="74">  pop_u_httk[, </a>
<a class="sourceLine" id="cb17-75" title="75">    Funbound.plasma<span class="op">:</span><span class="er">=</span>unadjusted.Funbound.plasma<span class="op">*</span>Funbound.plasma.adjustment]</a>
<a class="sourceLine" id="cb17-76" title="76"></a>
<a class="sourceLine" id="cb17-77" title="77"><span class="co"># Enforce a minimum ppb:</span></a>
<a class="sourceLine" id="cb17-78" title="78">  pop_u_httk[Funbound.plasma<span class="op">&lt;</span>minimum.Funbound.plasma,</a>
<a class="sourceLine" id="cb17-79" title="79">    Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma]</a>
<a class="sourceLine" id="cb17-80" title="80"></a>
<a class="sourceLine" id="cb17-81" title="81"><span class="co"># If Fup varies, then Rb2p and hepatic bioavailability also vary:</span></a>
<a class="sourceLine" id="cb17-82" title="82">  Rblood2plasma &lt;-<span class="st"> </span><span class="kw">get_rblood2plasma</span>(<span class="dt">chem.cas=</span>chemcas)</a>
<a class="sourceLine" id="cb17-83" title="83">  <span class="cf">if</span> (<span class="kw">is.na</span>(Rblood2plasma)) </a>
<a class="sourceLine" id="cb17-84" title="84">  {</a>
<a class="sourceLine" id="cb17-85" title="85">    pop_u_httk[, Rblood2plasma<span class="op">:</span><span class="er">=</span><span class="kw">calc_rblood2plasma</span>(<span class="dt">params=</span>pop_u_httk)]</a>
<a class="sourceLine" id="cb17-86" title="86">  <span class="co"># Right now we don&#39;t similate variability on a known blood:plasma ratio </span></a>
<a class="sourceLine" id="cb17-87" title="87">  } <span class="cf">else</span> pop_u_httk[, Rblood2plasma<span class="op">:</span><span class="er">=</span>Rblood2plasma] </a>
<a class="sourceLine" id="cb17-88" title="88"></a>
<a class="sourceLine" id="cb17-89" title="89">  <span class="co"># Parse the clint.dist to retrieve the quantiles:</span></a>
<a class="sourceLine" id="cb17-90" title="90">  Clint.dist &lt;-<span class="st"> </span>pop_u_httk[<span class="dv">1</span>,Clint.dist]</a>
<a class="sourceLine" id="cb17-91" title="91">  <span class="cf">if</span> (<span class="kw">nchar</span>(Clint.dist) <span class="op">-</span></a>
<a class="sourceLine" id="cb17-92" title="92"><span class="st">    </span><span class="kw">nchar</span>(<span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Clint.dist))<span class="op">!=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb17-93" title="93">  {</a>
<a class="sourceLine" id="cb17-94" title="94">    <span class="kw">stop</span>(<span class="st">&quot;Clint distribution should be four values (median,low95th,high95th,pValue) separated by commas.&quot;</span>)</a>
<a class="sourceLine" id="cb17-95" title="95">  }</a>
<a class="sourceLine" id="cb17-96" title="96">  temp &lt;-<span class="st"> </span><span class="kw">strsplit</span>(Clint.dist,<span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb17-97" title="97">  Clint.median &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb17-98" title="98">  Clint.low95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb17-99" title="99">  Clint.high95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb17-100" title="100">  Clint.pvalue &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-101" title="101">  </a>
<a class="sourceLine" id="cb17-102" title="102">  <span class="co"># Use optim to estimate mean and standard deviation of Clint such that the </span></a>
<a class="sourceLine" id="cb17-103" title="103">  <span class="co"># median and 95% credible interval approximate the estimate from MCMC:</span></a>
<a class="sourceLine" id="cb17-104" title="104">  <span class="cf">if</span> (Clint.high95<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-105" title="105">  {</a>
<a class="sourceLine" id="cb17-106" title="106">    <span class="cf">if</span> (Clint.median<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb17-107" title="107">    {</a>
<a class="sourceLine" id="cb17-108" title="108">      clint.fit &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="kw">log</span>(Clint.median),<span class="fl">0.3</span>), <span class="cf">function</span>(x) </a>
<a class="sourceLine" id="cb17-109" title="109">        (<span class="fl">0.95</span><span class="op">-</span><span class="kw">plnorm</span>(Clint.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="op">+</span><span class="kw">plnorm</span>(Clint.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span><span class="op">+</span></a>
<a class="sourceLine" id="cb17-110" title="110"><span class="st">        </span>(Clint.median<span class="op">-</span><span class="kw">qlnorm</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb17-111" title="111">      pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="kw">rlnorm</span>(<span class="dv">1000</span>,clint.fit<span class="op">$</span>par[<span class="dv">1</span>],clint.fit<span class="op">$</span>par[<span class="dv">2</span>])]</a>
<a class="sourceLine" id="cb17-112" title="112">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb17-113" title="113">      pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="kw">exp</span>(<span class="kw">runif</span>(<span class="dv">1000</span>,<span class="kw">log</span>(<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-114" title="114">      (<span class="kw">log</span>(Clint.high95)<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span>))<span class="op">/</span><span class="fl">0.975</span>))]</a>
<a class="sourceLine" id="cb17-115" title="115">    }</a>
<a class="sourceLine" id="cb17-116" title="116">  } <span class="cf">else</span> pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb17-117" title="117">  pop_u_httk[<span class="kw">as.logical</span>(<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,Clint.pvalue)),Clint<span class="op">:</span><span class="er">=</span><span class="dv">0</span>] <span class="co"># the Bayesian &quot;p-value&quot; here reflects how often there is no clearance</span></a>
<a class="sourceLine" id="cb17-118" title="118"></a>
<a class="sourceLine" id="cb17-119" title="119">  pop_u_httk[, CLh<span class="op">:</span><span class="er">=</span><span class="kw">calc_hepatic_clearance</span>(<span class="dt">chem.cas=</span>chemcas,</a>
<a class="sourceLine" id="cb17-120" title="120">    <span class="dt">parameters=</span>pop_u_httk,<span class="dt">hepatic.model=</span><span class="st">&#39;unscaled&#39;</span>,<span class="dt">suppress.messages=</span>T,<span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb17-121" title="121">  pop_u_httk[, Qliver<span class="op">:</span><span class="er">=</span>Qtotal.liverc<span class="op">*</span>BW<span class="op">^</span><span class="fl">0.75</span>]</a>
<a class="sourceLine" id="cb17-122" title="122">  pop_u_httk[, hepatic.bioavailability<span class="op">:</span><span class="er">=</span><span class="st"> </span>Qliver <span class="op">/</span><span class="st"> </span>(Qliver <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-123" title="123"><span class="st">    </span>Funbound.plasma <span class="op">*</span><span class="st"> </span>Clint <span class="op">/</span><span class="st"> </span>Rblood2plasma)]</a>
<a class="sourceLine" id="cb17-124" title="124">  pop_u_httk[, (<span class="kw">setdiff</span>(<span class="kw">names</span>(pop_u_httk), </a>
<a class="sourceLine" id="cb17-125" title="125">    <span class="kw">names</span>(httk<span class="op">::</span><span class="kw">parameterize_steadystate</span>(<span class="dt">chem.cas=</span>chemcas))))<span class="op">:</span><span class="er">=</span><span class="ot">NULL</span>]</a>
<a class="sourceLine" id="cb17-126" title="126"> </a>
<a class="sourceLine" id="cb17-127" title="127"> </a>
<a class="sourceLine" id="cb17-128" title="128">  <span class="co">#compute Css for each individual</span></a>
<a class="sourceLine" id="cb17-129" title="129">  <span class="co"># calc_analytic_css is vectorized so that this will work.</span></a>
<a class="sourceLine" id="cb17-130" title="130">  css &lt;-<span class="st"> </span>httk<span class="op">::</span><span class="kw">calc_analytic_css</span>(<span class="dt">parameters=</span>pop_u_httk,</a>
<a class="sourceLine" id="cb17-131" title="131">                                 <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-132" title="132">                                 <span class="dt">daily.dose=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-133" title="133">                                 <span class="dt">clint.pop.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb17-134" title="134">                                 <span class="dt">fup.pop.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb17-135" title="135">                                 <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb17-136" title="136">                                 <span class="dt">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</a>
<a class="sourceLine" id="cb17-137" title="137">                                 <span class="dt">species=</span><span class="st">&quot;Human&quot;</span>,</a>
<a class="sourceLine" id="cb17-138" title="138">                                 <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>)<span class="co">#,</span></a>
<a class="sourceLine" id="cb17-139" title="139">                            <span class="co">#     recalc.blood2plasma=TRUE)</span></a>
<a class="sourceLine" id="cb17-140" title="140">  <span class="co">#get Css95</span></a>
<a class="sourceLine" id="cb17-141" title="141">  cssquants &lt;-<span class="st"> </span><span class="kw">quantile</span>(css, <span class="dt">probs=</span>probs)</a>
<a class="sourceLine" id="cb17-142" title="142">  <span class="kw">return</span>(cssquants)</a>
<a class="sourceLine" id="cb17-143" title="143">}</a></code></pre></div>
</div>
<div id="this-calculates-the-half-life-using-uncertainty-only" class="section level3">
<h3>This calculates the half-life using uncertainty only:</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">hlfun_u &lt;-<span class="st"> </span><span class="cf">function</span>(chemcas, </a>
<a class="sourceLine" id="cb18-2" title="2">                      MW, </a>
<a class="sourceLine" id="cb18-3" title="3">                      <span class="dt">probs=</span><span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb18-4" title="4">                      <span class="dt">minimum.Funbound.plasma=</span><span class="fl">0.0001</span>)</a>
<a class="sourceLine" id="cb18-5" title="5">{</a>
<a class="sourceLine" id="cb18-6" title="6">  <span class="co"># Create a data table with uncertainty only:</span></a>
<a class="sourceLine" id="cb18-7" title="7">  <span class="kw">print</span>(chemcas)</a>
<a class="sourceLine" id="cb18-8" title="8">  pop_u_httk &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(<span class="kw">parameterize_steadystate</span>(<span class="dt">chem.cas=</span>chemcas,</a>
<a class="sourceLine" id="cb18-9" title="9">    <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb18-10" title="10">    <span class="dt">minimum.Funbound.plasma=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb18-11" title="11">  params.schmitt &lt;-<span class="kw">parameterize_schmitt</span>(<span class="dt">chem.cas=</span>chemcas)</a>
<a class="sourceLine" id="cb18-12" title="12">  psd &lt;-<span class="st"> </span>params.schmitt<span class="op">$</span>pKa_Donor</a>
<a class="sourceLine" id="cb18-13" title="13">  psa &lt;-<span class="st"> </span>params.schmitt<span class="op">$</span>pKa_Accept</a>
<a class="sourceLine" id="cb18-14" title="14">  params.schmitt &lt;-<span class="st"> </span>params.schmitt[<span class="kw">regexpr</span>(<span class="st">&quot;pKa&quot;</span>,<span class="kw">names</span>(params.schmitt))<span class="op">==-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb18-15" title="15">  pop_u_httk[,<span class="kw">names</span>(params.schmitt)<span class="op">:</span><span class="er">=</span>params.schmitt]</a>
<a class="sourceLine" id="cb18-16" title="16">  pop_u_httk[,pKa_Donor <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(psd, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>)]</a>
<a class="sourceLine" id="cb18-17" title="17">  pop_u_httk[,pKa_Accept <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste</span>(psa, <span class="dt">collapse=</span><span class="st">&quot;,&quot;</span>)]</a>
<a class="sourceLine" id="cb18-18" title="18">  pop_u_httk &lt;-<span class="st"> </span>pop_u_httk[<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>)]</a>
<a class="sourceLine" id="cb18-19" title="19"></a>
<a class="sourceLine" id="cb18-20" title="20">  ions &lt;-<span class="st"> </span><span class="kw">calc_ionization</span>(<span class="dt">pH=</span><span class="fl">7.4</span>,<span class="dt">parameters=</span>pop_u_httk)</a>
<a class="sourceLine" id="cb18-21" title="21">  pop_u_httk[,Dow74 <span class="op">:</span><span class="er">=</span><span class="st"> </span>Pow <span class="op">*</span><span class="st"> </span>(ions<span class="op">$</span>fraction_neutral <span class="op">+</span><span class="st"> </span><span class="fl">0.001</span> <span class="op">*</span><span class="st"> </span>ions<span class="op">$</span>fraction_charged <span class="op">+</span><span class="st"> </span>ions<span class="op">$</span>fraction_zwitter)]</a>
<a class="sourceLine" id="cb18-22" title="22">  </a>
<a class="sourceLine" id="cb18-23" title="23">  <span class="co"># Parse the Funbound.plasma.dist into quantiles:</span></a>
<a class="sourceLine" id="cb18-24" title="24">  Funbound.plasma.dist &lt;-<span class="st"> </span>pop_u_httk[<span class="dv">1</span>,Funbound.plasma.dist]</a>
<a class="sourceLine" id="cb18-25" title="25">  <span class="kw">print</span>(<span class="kw">paste</span>(chemcas,Funbound.plasma.dist))</a>
<a class="sourceLine" id="cb18-26" title="26">  <span class="cf">if</span> (<span class="kw">nchar</span>(Funbound.plasma.dist) <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="st">    </span><span class="kw">nchar</span>(<span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Funbound.plasma.dist))<span class="op">!=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-28" title="28">  {</a>
<a class="sourceLine" id="cb18-29" title="29">    <span class="kw">stop</span>(<span class="st">&quot;Funbound.plasma distribution should be three values (median,low95th,high95th) separated by commas.&quot;</span>)</a>
<a class="sourceLine" id="cb18-30" title="30">  }</a>
<a class="sourceLine" id="cb18-31" title="31">  temp &lt;-<span class="st"> </span><span class="kw">strsplit</span>(Funbound.plasma.dist,<span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb18-32" title="32">  ppb.median &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb18-33" title="33">  ppb.low95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb18-34" title="34">  ppb.high95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb18-35" title="35">  </a>
<a class="sourceLine" id="cb18-36" title="36">  <span class="cf">if</span> (ppb.median<span class="op">&gt;</span>minimum.Funbound.plasma)</a>
<a class="sourceLine" id="cb18-37" title="37">  {</a>
<a class="sourceLine" id="cb18-38" title="38">    <span class="co"># Use optim to estimate alpha and beta for fup such that the median and 95% </span></a>
<a class="sourceLine" id="cb18-39" title="39">    <span class="co"># credible interval approximate the estimate from MCMC:</span></a>
<a class="sourceLine" id="cb18-40" title="40">    ppb.fit &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="dv">2</span>,(<span class="dv">1</span><span class="op">-</span>ppb.median)<span class="op">/</span>ppb.median<span class="op">*</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb18-41" title="41">      <span class="cf">function</span>(x) (<span class="fl">0.95</span><span class="op">-</span><span class="kw">pbeta</span>(ppb.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="op">+</span></a>
<a class="sourceLine" id="cb18-42" title="42"><span class="st">      </span><span class="kw">pbeta</span>(ppb.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span><span class="op">+</span></a>
<a class="sourceLine" id="cb18-43" title="43"><span class="st">      </span>(ppb.median<span class="op">-</span><span class="kw">qbeta</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb18-44" title="44">      <span class="dt">method=</span><span class="st">&quot;BFGS&quot;</span>)</a>
<a class="sourceLine" id="cb18-45" title="45">  <span class="co"># We are drawing new values for the unadjusted Fup:</span></a>
<a class="sourceLine" id="cb18-46" title="46">    pop_u_httk[, unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span><span class="kw">rbeta</span>(<span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb18-47" title="47">      ppb.fit<span class="op">$</span>par[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb18-48" title="48">      ppb.fit<span class="op">$</span>par[<span class="dv">2</span>])]</a>
<a class="sourceLine" id="cb18-49" title="49">  } <span class="cf">else</span> <span class="cf">if</span> (ppb.high95<span class="op">&gt;</span>minimum.Funbound.plasma)</a>
<a class="sourceLine" id="cb18-50" title="50">  {</a>
<a class="sourceLine" id="cb18-51" title="51">    <span class="co"># Assume that since the median is zero but the u95 is not, that there is </span></a>
<a class="sourceLine" id="cb18-52" title="52">    <span class="co"># an exponential distribution:</span></a>
<a class="sourceLine" id="cb18-53" title="53">    <span class="co"># 97.5% of clearance values will be below Funbound.plasma.u95:</span></a>
<a class="sourceLine" id="cb18-54" title="54">    pop_u_httk[, unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span><span class="kw">runif</span>(<span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb18-55" title="55">      minimum.Funbound.plasma,</a>
<a class="sourceLine" id="cb18-56" title="56">      <span class="kw">min</span>(<span class="dv">1</span>,(ppb.high95<span class="op">-</span>minimum.Funbound.plasma)<span class="op">/</span><span class="fl">0.975</span>))]</a>
<a class="sourceLine" id="cb18-57" title="57">    pop_u_httk[<span class="kw">as.logical</span>(<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,.<span class="dv">975</span>)),</a>
<a class="sourceLine" id="cb18-58" title="58">      unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma]</a>
<a class="sourceLine" id="cb18-59" title="59">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb18-60" title="60">    pop_u_httk[, unadjusted.Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma]</a>
<a class="sourceLine" id="cb18-61" title="61">  }</a>
<a class="sourceLine" id="cb18-62" title="62">  </a>
<a class="sourceLine" id="cb18-63" title="63"><span class="co"># then we need to adjust for in vitro binding:</span></a>
<a class="sourceLine" id="cb18-64" title="64">  pop_u_httk[,Flipid<span class="op">:</span><span class="er">=</span><span class="kw">subset</span>(physiology.data,</a>
<a class="sourceLine" id="cb18-65" title="65">    Parameter<span class="op">==</span><span class="st">&#39;Plasma Effective Neutral Lipid Volume Fraction&#39;</span>)[,</a>
<a class="sourceLine" id="cb18-66" title="66">    <span class="kw">which</span>(<span class="kw">colnames</span>(physiology.data) <span class="op">==</span><span class="st"> &#39;Human&#39;</span>)]]</a>
<a class="sourceLine" id="cb18-67" title="67">  pop_u_httk[,Funbound.plasma.adjustment<span class="op">:</span><span class="er">=</span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(Dow74 <span class="op">*</span><span class="st"> </span>Flipid <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-68" title="68"><span class="st">    </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>unadjusted.Funbound.plasma)<span class="op">/</span>unadjusted.Funbound.plasma]</a>
<a class="sourceLine" id="cb18-69" title="69">  pop_u_httk[, </a>
<a class="sourceLine" id="cb18-70" title="70">    Funbound.plasma<span class="op">:</span><span class="er">=</span>unadjusted.Funbound.plasma<span class="op">*</span>Funbound.plasma.adjustment]</a>
<a class="sourceLine" id="cb18-71" title="71"></a>
<a class="sourceLine" id="cb18-72" title="72"><span class="co"># Enforce a minimum ppb:</span></a>
<a class="sourceLine" id="cb18-73" title="73">  pop_u_httk[Funbound.plasma<span class="op">&lt;</span>minimum.Funbound.plasma,</a>
<a class="sourceLine" id="cb18-74" title="74">    Funbound.plasma<span class="op">:</span><span class="er">=</span>minimum.Funbound.plasma]</a>
<a class="sourceLine" id="cb18-75" title="75"></a>
<a class="sourceLine" id="cb18-76" title="76">  Rblood2plasma &lt;-<span class="st"> </span><span class="kw">get_rblood2plasma</span>(<span class="dt">chem.cas=</span>chemcas)</a>
<a class="sourceLine" id="cb18-77" title="77">  <span class="cf">if</span> (<span class="kw">is.na</span>(Rblood2plasma)) </a>
<a class="sourceLine" id="cb18-78" title="78">  {</a>
<a class="sourceLine" id="cb18-79" title="79">    pop_u_httk[, Rblood2plasma<span class="op">:</span><span class="er">=</span><span class="kw">calc_rblood2plasma</span>(<span class="dt">params=</span>pop_u_httk)]</a>
<a class="sourceLine" id="cb18-80" title="80">  } <span class="cf">else</span> pop_u_httk[, Rblood2plasma<span class="op">:</span><span class="er">=</span>Rblood2plasma] <span class="co"># Right now we don&#39;t similate variability on a known blood:plasma ratio </span></a>
<a class="sourceLine" id="cb18-81" title="81">  <span class="co"># Parse the clint.dist to retrieve the quantiles:</span></a>
<a class="sourceLine" id="cb18-82" title="82">  Clint.dist &lt;-<span class="st"> </span>pop_u_httk[<span class="dv">1</span>,Clint.dist]</a>
<a class="sourceLine" id="cb18-83" title="83">  <span class="cf">if</span> (<span class="kw">nchar</span>(Clint.dist) <span class="op">-</span></a>
<a class="sourceLine" id="cb18-84" title="84"><span class="st">    </span><span class="kw">nchar</span>(<span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Clint.dist))<span class="op">!=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb18-85" title="85">  {</a>
<a class="sourceLine" id="cb18-86" title="86">    <span class="kw">stop</span>(<span class="st">&quot;Clint distribution should be four values (median,low95th,high95th,pValue) separated by commas.&quot;</span>)</a>
<a class="sourceLine" id="cb18-87" title="87">  }</a>
<a class="sourceLine" id="cb18-88" title="88">  temp &lt;-<span class="st"> </span><span class="kw">strsplit</span>(Clint.dist,<span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb18-89" title="89">  Clint.median &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb18-90" title="90">  Clint.low95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb18-91" title="91">  Clint.high95 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb18-92" title="92">  Clint.pvalue &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(temp[[<span class="dv">1</span>]][<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb18-93" title="93">  </a>
<a class="sourceLine" id="cb18-94" title="94">  <span class="co"># Use optim to estimate mean and standard deviation of Clint such that the </span></a>
<a class="sourceLine" id="cb18-95" title="95">  <span class="co"># median and 95% credible interval approximate the estimate from MCMC:</span></a>
<a class="sourceLine" id="cb18-96" title="96">  <span class="cf">if</span> (Clint.high95<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-97" title="97">  {</a>
<a class="sourceLine" id="cb18-98" title="98">    <span class="cf">if</span> (Clint.median<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb18-99" title="99">    {</a>
<a class="sourceLine" id="cb18-100" title="100">      clint.fit &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="kw">log</span>(Clint.median),<span class="fl">0.3</span>), <span class="cf">function</span>(x) </a>
<a class="sourceLine" id="cb18-101" title="101">        (<span class="fl">0.95</span><span class="op">-</span><span class="kw">plnorm</span>(Clint.high95,x[<span class="dv">1</span>],x[<span class="dv">2</span>])<span class="op">+</span><span class="kw">plnorm</span>(Clint.low95,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span><span class="op">+</span></a>
<a class="sourceLine" id="cb18-102" title="102"><span class="st">        </span>(Clint.median<span class="op">-</span><span class="kw">qlnorm</span>(<span class="fl">0.5</span>,x[<span class="dv">1</span>],x[<span class="dv">2</span>]))<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb18-103" title="103">      pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="kw">rlnorm</span>(<span class="dv">1000</span>,clint.fit<span class="op">$</span>par[<span class="dv">1</span>],clint.fit<span class="op">$</span>par[<span class="dv">2</span>])]</a>
<a class="sourceLine" id="cb18-104" title="104">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb18-105" title="105">      pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="kw">exp</span>(<span class="kw">runif</span>(<span class="dv">1000</span>,<span class="kw">log</span>(<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-106" title="106">      (<span class="kw">log</span>(Clint.high95)<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span>))<span class="op">/</span><span class="fl">0.975</span>))]</a>
<a class="sourceLine" id="cb18-107" title="107">    }</a>
<a class="sourceLine" id="cb18-108" title="108">  } <span class="cf">else</span> pop_u_httk[,Clint<span class="op">:</span><span class="er">=</span><span class="dv">0</span>]</a>
<a class="sourceLine" id="cb18-109" title="109">  pop_u_httk[<span class="kw">as.logical</span>(<span class="kw">rbinom</span>(<span class="dv">1000</span>,<span class="dv">1</span>,Clint.pvalue)),Clint<span class="op">:</span><span class="er">=</span><span class="dv">0</span>] <span class="co"># the Bayesian &quot;p-value&quot; here reflects how often there is no clearance</span></a>
<a class="sourceLine" id="cb18-110" title="110"></a>
<a class="sourceLine" id="cb18-111" title="111">  pop_u_httk[, CLh<span class="op">:</span><span class="er">=</span><span class="kw">calc_hepatic_clearance</span>(<span class="dt">chem.cas=</span>chemcas,<span class="dt">parameters=</span>pop_u_httk,<span class="dt">hepatic.model=</span><span class="st">&#39;unscaled&#39;</span>,<span class="dt">suppress.messages=</span>T,<span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb18-112" title="112">  pop_u_httk[, Qliver<span class="op">:</span><span class="er">=</span>Qtotal.liverc<span class="op">*</span>BW<span class="op">^</span><span class="fl">0.75</span>]</a>
<a class="sourceLine" id="cb18-113" title="113">  pop_u_httk[, hepatic.bioavailability<span class="op">:</span><span class="er">=</span><span class="st"> </span>Qliver <span class="op">/</span><span class="st"> </span>(Qliver <span class="op">+</span><span class="st"> </span>Funbound.plasma <span class="op">*</span><span class="st"> </span>Clint <span class="op">/</span><span class="st"> </span>Rblood2plasma)]</a>
<a class="sourceLine" id="cb18-114" title="114"></a>
<a class="sourceLine" id="cb18-115" title="115">  PC.names &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">predict_partitioning_schmitt</span>(<span class="dt">chem.cas=</span><span class="st">&quot;80-05-7&quot;</span>))</a>
<a class="sourceLine" id="cb18-116" title="116">  pop_u_httk&lt;-<span class="kw">cbind</span>(pop_u_httk,<span class="kw">as.data.table</span>(<span class="kw">predict_partitioning_schmitt</span>(<span class="dt">parameters=</span>pop_u_httk)))</a>
<a class="sourceLine" id="cb18-117" title="117">  pop_u_httk[,hl<span class="op">:</span><span class="er">=</span><span class="kw">calc_elimination_rate</span>(<span class="dt">parameters=</span>pop_u_httk)]</a>
<a class="sourceLine" id="cb18-118" title="118">  </a>
<a class="sourceLine" id="cb18-119" title="119">  <span class="kw">return</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">/</span><span class="kw">quantile</span>(<span class="kw">unlist</span>(pop_u_httk[,<span class="st">&quot;hl&quot;</span>,<span class="dt">with=</span>F]),<span class="dt">probs=</span>probs))</a>
<a class="sourceLine" id="cb18-120" title="120">}</a></code></pre></div>
</div>
<div id="figure-1" class="section level3">
<h3>Figure 1:</h3>
<p>Histograms depicting the median measured values (a, b) and 95% credible intervals (c, d) for fraction unbound in plasma (fup, a,c) and intrinsic hepatic clearance (Clint, b,d). In panel a, the distribution of estimated fup for the single protein concentration assay (solid line) is compared with the protein titration (three concentrations) method (dotted) line. In panel b, the median estimated Clint is shown. In panel c, the distribution with larger credible intervals corresponds to the single protein concentration assay, with a median credible interval is 0.1, corresponding to a precision of roughly ±0.05. When data from the protein titration are jointly analyzed (smaller credible intervals), the certainty is increased to a median credible interval of 0.029, or roughly ±0.015. The width of the credible interval is a measure of the certainty in an estimate, i.e., a smaller credible interval indicates greater certainty. For the fup values, a credible interval approaching 1 indicates that all possible values are consistent with the data – that is, the data do not help identify fup since fup must be between 0 and 1. In panel d the distribution of credible intervals for Clint is shown.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">Fig1.table &lt;-<span class="st"> </span>httk<span class="op">::</span>wambaugh2019.raw</a>
<a class="sourceLine" id="cb19-2" title="2">Fig1.table<span class="op">$</span>Error1 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Base.Fup.High <span class="op">-</span><span class="st"> </span>Fig1.table<span class="op">$</span>Base.Fup.Low</a>
<a class="sourceLine" id="cb19-3" title="3">Fig1.table<span class="op">$</span>Error2 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Affinity.Fup.High <span class="op">-</span><span class="st"> </span>Fig1.table<span class="op">$</span>Affinity.Fup.Low</a>
<a class="sourceLine" id="cb19-4" title="4">Fig1.table<span class="op">$</span>Sigma1 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Error1<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-5" title="5">Fig1.table<span class="op">$</span>Mean1 &lt;-<span class="st"> </span>(Fig1.table<span class="op">$</span>Base.Fup.High <span class="op">+</span><span class="st"> </span>Fig1.table<span class="op">$</span>Base.Fup.Low)<span class="op">/</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-6" title="6">Fig1.table<span class="op">$</span>CV1 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Sigma1<span class="op">/</span>Fig1.table<span class="op">$</span>Mean1</a>
<a class="sourceLine" id="cb19-7" title="7">Fig1.table<span class="op">$</span>Sigma2 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Error2<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-8" title="8">Fig1.table<span class="op">$</span>Mean2 &lt;-<span class="st"> </span>(Fig1.table<span class="op">$</span>Base.Fup.High <span class="op">+</span><span class="st"> </span>Fig1.table<span class="op">$</span>Base.Fup.Low)<span class="op">/</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-9" title="9">Fig1.table<span class="op">$</span>CV2 &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>Sigma2<span class="op">/</span>Fig1.table<span class="op">$</span>Mean2</a>
<a class="sourceLine" id="cb19-10" title="10">Fig1.table<span class="op">$</span>ErrorClint &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.High95th <span class="op">-</span><span class="st"> </span>Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Low95th</a>
<a class="sourceLine" id="cb19-11" title="11">Fig1.table<span class="op">$</span>SigmaClint &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>ErrorClint<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-12" title="12">Fig1.table<span class="op">$</span>MeanClint &lt;-<span class="st"> </span>(Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.High95th <span class="op">+</span><span class="st"> </span>Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Low95th)<span class="op">/</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb19-13" title="13">Fig1.table<span class="op">$</span>CVClint &lt;-<span class="st"> </span>Fig1.table<span class="op">$</span>SigmaClint<span class="op">/</span>Fig1.table<span class="op">$</span>MeanClint</a>
<a class="sourceLine" id="cb19-14" title="14"></a>
<a class="sourceLine" id="cb19-15" title="15">Fupmeasured &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med))</a>
<a class="sourceLine" id="cb19-16" title="16">Fupmeasured &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupmeasured,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb19-17" title="17">CLintmeasured &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(CLint<span class="fl">.1</span>uM.Median))</a>
<a class="sourceLine" id="cb19-18" title="18">CLintmeasured &lt;-<span class="st"> </span><span class="kw">subset</span>(CLintmeasured,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb19-19" title="19"></a>
<a class="sourceLine" id="cb19-20" title="20"></a>
<a class="sourceLine" id="cb19-21" title="21"></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;New HTTK experimental measurements were made for&quot;</span>,<span class="kw">length</span>(<span class="kw">unique</span>(Fig1.table<span class="op">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;New HTTK experimental measurements were made for 496 chemicals from the ToxCast HTS library.&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Fup was successfully measured for&quot;</span>,<span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med))<span class="op">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;Fup was successfully measured for 418 chemicals from the ToxCast HTS library.&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;CLint was successfully measured for&quot;</span>,<span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(CLint<span class="fl">.1</span>uM.Median))<span class="op">$</span>CAS)),<span class="st">&quot;chemicals from the ToxCast HTS library.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;CLint was successfully measured for 467 chemicals from the ToxCast HTS library.&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">Fig1a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Fig1.table)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="st">   </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>,<span class="dt">lwd=</span><span class="fl">1.5</span>,<span class="dt">color=</span><span class="st">&quot;Red&quot;</span>,<span class="kw">aes</span>(Base.Fup.Med))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">   </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>,<span class="dt">lwd=</span><span class="fl">1.5</span>,<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;Blue&quot;</span>,<span class="kw">aes</span>(Affinity.Fup.Med))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,F[up]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">   </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="fl">1.05</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#  scale_y_continuous(limits=c(0,65))+</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">#  annotate(&quot;text&quot;, x=10^-3, y = 60, hjust=0.5,size=4,label = paste(dim(subset(Fig1.table,!is.na(Affinity.Fup.Med)))[1],&quot;Chemicals Measured&quot;))+</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">paste</span>(<span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med))<span class="op">$</span>CAS)),<span class="st">&quot;Chemicals Measured&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">#    annotate(&quot;text&quot;, x=10^-3, y = 50, hjust=0.5,size=4,color=&quot;Red&quot;,label = paste(&quot;Median 100%:&quot;,signif(median(Fig1.table$Base.Fup.Med,na.rm=T),2)))+</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">#    annotate(&quot;text&quot;, x =10^-3, y = 40, hjust=0.5,size=4,color=&quot;Blue&quot;,label = paste(&quot;Median Titration:&quot;,signif(median(Fig1.table$Affinity.Fup.Med,na.rm=T),2)))+</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-14" title="14"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dt">y=</span><span class="dv">80</span>,<span class="dt">size=</span><span class="dv">8</span>,<span class="dt">label=</span><span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb25-15" title="15"><span class="kw">dev.new</span>()        </a>
<a class="sourceLine" id="cb25-16" title="16"><span class="kw">print</span>(Fig1a)    </a></code></pre></div>
<pre><code>## Warning: Removed 98 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 148 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_path).

## Warning: Removed 2 rows containing missing values (geom_path).</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median 100%:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Base.Fup.Med,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;Median 100%: 0.032&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median Titration:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Affinity.Fup.Med,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;Median Titration: 0.028&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">Fig1b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Fig1.table)<span class="op">+</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>,<span class="dt">alpha=</span><span class="fl">0.6</span>,<span class="dt">fill=</span><span class="st">&quot;green&quot;</span>,<span class="kw">aes</span>(CLint<span class="fl">.1</span>uM.Median))<span class="op">+</span><span class="st">              </span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">   </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Measured &quot;</span>,Cl[int],<span class="st">&quot; (µL/min/&quot;</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">6</span>,<span class="st">&quot; hepatocytes)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co">#  scale_y_continuous(limits=c(0,40))+</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co">#  annotate(&quot;text&quot;, x=5*10^1, y = 35, hjust=0.5,size=4,label = paste(dim(subset(Fig1.table,!is.na(CLint.1uM.Median)))[1],&quot;Chemicals Measured&quot;))+</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">paste</span>(<span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(Fig1.table,<span class="op">!</span><span class="kw">is.na</span>(CLint<span class="fl">.1</span>uM.Median))<span class="op">$</span>CAS)),<span class="st">&quot;Chemicals Measured&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="co">#    annotate(&quot;text&quot;, x=5*10^1, y = 30, hjust=0.5,size=4,label = paste(sum(Fig1.table$CLint.1uM.Median==0,na.rm=T),&quot;Zero Measurments&quot;))+</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="co">#    annotate(&quot;text&quot;, x =5*10^1, y = 25, hjust=0.5,size=4,label = paste(&quot;Median Non-Zero:&quot;,signif(median(Fig1.table$CLint.1uM.Median,na.rm=T),3)))+</span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">2</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dt">y=</span><span class="dv">80</span>,<span class="dt">size=</span><span class="dv">8</span>,<span class="dt">label=</span><span class="st">&quot;b&quot;</span>)</a>
<a class="sourceLine" id="cb33-14" title="14">        </a>
<a class="sourceLine" id="cb33-15" title="15"><span class="kw">print</span>(Fig1b)    </a></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 202 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">==</span><span class="dv">0</span>,<span class="dt">na.rm=</span>T),<span class="st">&quot;Zero Measurments&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;142 Zero Measurments&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median Non-Zero:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median,<span class="dt">na.rm=</span>T),<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;Median Non-Zero: 16&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">Fig1c &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Fig1.table)<span class="op">+</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>,<span class="dt">alpha=</span><span class="fl">0.2</span>,<span class="dt">fill=</span><span class="st">&quot;Red&quot;</span>,<span class="kw">aes</span>(Error1))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>,<span class="dt">alpha=</span><span class="fl">0.2</span>,<span class="dt">fill=</span><span class="st">&quot;Blue&quot;</span>,<span class="kw">aes</span>(Error2))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Width of Credible Interval&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="st">   </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>,<span class="fl">1.05</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co">#  scale_y_continuous(limits=c(0,1.5))+</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="co">#    annotate(&quot;text&quot;, x=5*10^-2, y = 60, hjust=0.5,size=4,color=&quot;Red&quot;,label = paste(&quot;Median 100% CI:&quot;,signif(median(Fig1.table$Error1,na.rm=T),2),&quot;CV:&quot;,signif(median(Fig1.table$CV1,na.rm=T),2)))+</span></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co">#    annotate(&quot;text&quot;, x =5*10^-2, y = 50, hjust=0.5,size=4,color=&quot;Blue&quot;,label = paste(&quot;Median Titr. CI:&quot;,signif(median(Fig1.table$Error2,na.rm=T),2),&quot;CV:&quot;,signif(median(Fig1.table$CV2,na.rm=T),2)))+</span></a>
<a class="sourceLine" id="cb41-10" title="10"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">paste</span>(<span class="st">&quot;CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Error1,<span class="dt">na.rm=</span>T),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CV1,<span class="dt">na.rm=</span>T),<span class="dv">1</span>),<span class="st">&quot;/ CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Error2,<span class="dt">na.rm=</span>T),<span class="dv">1</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CV2,<span class="dt">na.rm=</span>T),<span class="dv">1</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb41-13" title="13"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">5</span><span class="op">*</span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span>,<span class="dt">y=</span><span class="dv">42</span>,<span class="dt">size=</span><span class="dv">8</span>,<span class="dt">label=</span><span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb41-14" title="14">        </a>
<a class="sourceLine" id="cb41-15" title="15"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median 100% CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Error1,<span class="dt">na.rm=</span>T),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CV1,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))    </a></code></pre></div>
<pre><code>## [1] &quot;Median 100% CI: 0.1 CV: 0.42&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median Titr. CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>Error2,<span class="dt">na.rm=</span>T),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CV2,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;Median Titr. CI: 0.029 CV: 0.1&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">print</span>(Fig1c)</a></code></pre></div>
<pre><code>## Warning: Removed 91 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 85 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).

## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">Fig1d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Fig1.table)<span class="op">+</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="st">   </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.1</span>,<span class="dt">alpha=</span><span class="fl">0.6</span>,<span class="dt">fill=</span><span class="st">&quot;green&quot;</span>,<span class="kw">aes</span>(ErrorClint))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Width of Credible Interval&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">0</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="co">#  scale_y_continuous(limits=c(0,40))+</span></a>
<a class="sourceLine" id="cb49-7" title="7"><span class="co">#   annotate(&quot;text&quot;, x =5*10^1, y = 35, hjust=0.5,size=4,label = paste(&quot;Median CI:&quot;,signif(median(Fig1.table$ErrorClint,na.rm=T),2),&quot;CV:&quot;,signif(median(Fig1.table$CVClint,na.rm=T),2)))+</span></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="kw">paste</span>(<span class="st">&quot;Median CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>ErrorClint,<span class="dt">na.rm=</span>T),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CVClint,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb49-9" title="9"><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb49-10" title="10"><span class="st">    </span><span class="kw">theme</span>( <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb49-11" title="11"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="fl">1.5</span>,<span class="dt">y=</span><span class="dv">25</span>,<span class="dt">size=</span><span class="dv">8</span>,<span class="dt">label=</span><span class="st">&quot;d&quot;</span>)</a>
<a class="sourceLine" id="cb49-12" title="12">        </a>
<a class="sourceLine" id="cb49-13" title="13"><span class="kw">print</span>(Fig1d)  </a></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 246 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Median CI:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>ErrorClint,<span class="dt">na.rm=</span>T),<span class="dv">2</span>),<span class="st">&quot;CV:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fig1.table<span class="op">$</span>CVClint,<span class="dt">na.rm=</span>T),<span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;Median CI: 14 CV: 0.31&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">dev.new</span>()</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">multiplot</span>(Fig1a,Fig1c,Fig1b,Fig1d,<span class="dt">cols=</span><span class="dv">2</span>,<span class="dt">widths=</span><span class="kw">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</a></code></pre></div>
<pre><code>## Warning: Removed 98 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 148 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_path).

## Warning: Removed 2 rows containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 91 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 85 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).

## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 202 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 246 rows containing non-finite values (stat_bin).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<p>#Figure 2: Distribution of Binding Affinities Employed in Bayesian fup Estimations. To jointly analyze the data from the RED assay conducted at three protein concentrations, a model for binding to protein with an dissociation constant (i.e., binding affinity) must be assumed. Although the specific binding protein (for example, hemoglobin) and the stoichiometry are unknown, this number provides a rough estimate for each chemical of how much that chemical would be expected to be impacted by the presence of plasma binding.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">Fig2.table &lt;-<span class="st"> </span>httk<span class="op">::</span>wambaugh2019.raw</a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Fup.point)),<span class="st">&quot;total successful Fup estimates using point estimation.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;437 total successful Fup estimates using point estimation.&quot;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Base.Fup.Med)),<span class="st">&quot;total successful Fup estimates using BAyesian analysis of top protein concentration.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;439 total successful Fup estimates using BAyesian analysis of top protein concentration.&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">Fig2.table<span class="op">$</span>Error1 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Base.Fup.High <span class="op">-</span><span class="st"> </span>Fig2.table<span class="op">$</span>Base.Fup.Low</a>
<a class="sourceLine" id="cb72-2" title="2">Fig2.table<span class="op">$</span>Error2 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Affinity.Fup.High <span class="op">-</span><span class="st"> </span>Fig2.table<span class="op">$</span>Affinity.Fup.Low</a>
<a class="sourceLine" id="cb72-3" title="3">Fig2.table<span class="op">$</span>Sigma1 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Error1<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb72-4" title="4">Fig2.table<span class="op">$</span>Mean1 &lt;-<span class="st"> </span>(Fig2.table<span class="op">$</span>Base.Fup.High <span class="op">+</span><span class="st"> </span>Fig2.table<span class="op">$</span>Base.Fup.Low)<span class="op">/</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb72-5" title="5">Fig2.table<span class="op">$</span>CV1 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Sigma1<span class="op">/</span>Fig2.table<span class="op">$</span>Mean1</a>
<a class="sourceLine" id="cb72-6" title="6">Fig2.table<span class="op">$</span>Sigma2 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Error2<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb72-7" title="7">Fig2.table<span class="op">$</span>Mean2 &lt;-<span class="st"> </span>(Fig2.table<span class="op">$</span>Base.Fup.High <span class="op">+</span><span class="st"> </span>Fig2.table<span class="op">$</span>Base.Fup.Low)<span class="op">/</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>))</a>
<a class="sourceLine" id="cb72-8" title="8">Fig2.table<span class="op">$</span>CV2 &lt;-<span class="st"> </span>Fig2.table<span class="op">$</span>Sigma2<span class="op">/</span>Fig2.table<span class="op">$</span>Mean2</a>
<a class="sourceLine" id="cb72-9" title="9">Fig2.table<span class="op">$</span>Point.Estimate &lt;-<span class="st"> &quot;Good&quot;</span>                          </a>
<a class="sourceLine" id="cb72-10" title="10">Fig2.table[Fig2.table<span class="op">$</span>Fup.point<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]&lt;-<span class="st">&quot;&lt;0&quot;</span></a>
<a class="sourceLine" id="cb72-11" title="11">Fig2.table[Fig2.table<span class="op">$</span>Fup.point<span class="op">&gt;</span><span class="dv">1</span><span class="op">&amp;!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]&lt;-<span class="st">&quot;&gt;1&quot;</span></a>
<a class="sourceLine" id="cb72-12" title="12">Fig2.table[<span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Fup.point),<span class="st">&quot;Point.Estimate&quot;</span>]&lt;-<span class="st">&quot;No Value&quot;</span></a>
<a class="sourceLine" id="cb72-13" title="13">Fig2.table[Fig2.table<span class="op">$</span>Point.Estimate<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;&lt;0&quot;</span>,<span class="st">&quot;No Value&quot;</span>),<span class="st">&quot;Fup.point&quot;</span>] &lt;-<span class="st">  </span>Fig2.table[Fig2.table<span class="op">$</span>Point.Estimate<span class="op">%in%</span><span class="kw">c</span>(<span class="st">&quot;&lt;0&quot;</span>,<span class="st">&quot;No Value&quot;</span>),<span class="st">&quot;Base.Fup.Med&quot;</span>]</a>
<a class="sourceLine" id="cb72-14" title="14">Fig2.table<span class="op">$</span>Uncertain&lt;-<span class="st">&quot;Yes&quot;</span></a>
<a class="sourceLine" id="cb72-15" title="15">Fig2.table[<span class="kw">is.na</span>(Fig2.table<span class="op">$</span>CV1),<span class="st">&quot;CV1&quot;</span>] &lt;-<span class="st"> </span><span class="dv">-999</span></a>
<a class="sourceLine" id="cb72-16" title="16">Fig2.table[Fig2.table<span class="op">$</span>CV1<span class="op">&lt;</span><span class="fl">0.49</span>,<span class="st">&quot;Uncertain&quot;</span>] &lt;-<span class="st"> &quot;No&quot;</span></a>
<a class="sourceLine" id="cb72-17" title="17">Fig2.table[Fig2.table<span class="op">$</span>CV1<span class="op">==-</span><span class="dv">999</span>,<span class="st">&quot;CV1&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb72-18" title="18"></a>
<a class="sourceLine" id="cb72-19" title="19">Fig2a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Base.Fup.Med)),<span class="kw">aes</span>(<span class="dt">x=</span>Fup.point,<span class="dt">y=</span>Base.Fup.Med,<span class="dt">shape=</span>Point.Estimate,<span class="dt">alpha=</span>Uncertain,<span class="dt">colour=</span>Point.Estimate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-20" title="20"><span class="st">         </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb72-21" title="21"><span class="co">#         geom_errorbar(aes(ymax = Base.Fup.High, ymin=Base.Fup.Low))+</span></a>
<a class="sourceLine" id="cb72-22" title="22"><span class="st">   </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-23" title="23"><span class="st">   </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-24" title="24"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Single Conc.)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-25" title="25"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(F[up],<span class="st">&quot; Point Estimate (Traditional Analysis)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-26" title="26"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;Blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-27" title="27"><span class="co">#  geom_vline(xintercept = 1, size=2,linetype=&quot;dashed&quot;, colour=&quot;red&quot;)+</span></a>
<a class="sourceLine" id="cb72-28" title="28"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.01</span>, <span class="dt">size=</span><span class="dv">2</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb72-29" title="29"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.01</span>, <span class="dt">size=</span><span class="dv">2</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb72-30" title="30"><span class="st">    </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Point Estimate&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-31" title="31"><span class="st">    </span><span class="kw">scale_shape_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Point Estimate&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-32" title="32"><span class="st">    </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb72-33" title="33"><span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb72-34" title="34"><span class="st">     </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb72-35" title="35"><span class="st">     </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span> <span class="st">&quot;a&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb72-36" title="36"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">alpha=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb72-37" title="37"></a>
<a class="sourceLine" id="cb72-38" title="38"><span class="co">#print(Fig2a)</span></a>
<a class="sourceLine" id="cb72-39" title="39"></a>
<a class="sourceLine" id="cb72-40" title="40"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(Fig2.table<span class="op">$</span>Uncertain<span class="op">==</span><span class="st">&quot;Yes&quot;</span>),<span class="st">&quot;uncertain estimates using single conc.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;204 uncertain estimates using single conc.&quot;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(Fig2.table<span class="op">$</span>Point.Estimate<span class="op">==</span><span class="st">&quot;&lt;0&quot;</span>),<span class="st">&quot;chemicals with negative point estimates.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;40 chemicals with negative point estimates.&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(Fig2.table<span class="op">$</span>Point.Estimate<span class="op">==</span><span class="st">&quot;&gt;1&quot;</span>),<span class="st">&quot;chemicals with Fup &gt; 1.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;17 chemicals with Fup &gt; 1.&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Fup.point)<span class="op">&amp;</span>Fup.point<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;</span>Base.Fup.Med<span class="op">&gt;</span><span class="dv">0</span>),<span class="kw">log</span>(Fup.point)<span class="op">~</span><span class="kw">log</span>(Base.Fup.Med)))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Fup.point) ~ log(Base.Fup.Med), data = subset(Fig2.table, 
##     !is.na(Fup.point) &amp; Fup.point &gt; 0 &amp; Base.Fup.Med &gt; 0))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.3128 -1.6260  0.1525  1.2047 11.2200 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -1.33838    0.21342  -6.271 9.09e-10 ***
## log(Base.Fup.Med)  0.53667    0.02775  19.342  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.854 on 411 degrees of freedom
## Multiple R-squared:  0.4765, Adjusted R-squared:  0.4752 
## F-statistic: 374.1 on 1 and 411 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">Fig2.table<span class="op">$</span>Uncertain2&lt;-<span class="st">&quot;Yes&quot;</span></a>
<a class="sourceLine" id="cb80-2" title="2">Fig2.table[<span class="kw">is.na</span>(Fig2.table<span class="op">$</span>CV2),<span class="st">&quot;CV2&quot;</span>] &lt;-<span class="st"> </span><span class="dv">-999</span></a>
<a class="sourceLine" id="cb80-3" title="3">Fig2.table[Fig2.table<span class="op">$</span>CV2<span class="op">&lt;</span><span class="fl">0.49</span>,<span class="st">&quot;Uncertain2&quot;</span>] &lt;-<span class="st"> &quot;No&quot;</span></a>
<a class="sourceLine" id="cb80-4" title="4">Fig2.table[Fig2.table<span class="op">$</span>CV2<span class="op">==-</span><span class="dv">999</span>,<span class="st">&quot;CV2&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb80-5" title="5">Fig2.table<span class="op">$</span>TopFail &lt;-<span class="st"> &quot;&quot;</span></a>
<a class="sourceLine" id="cb80-6" title="6">Fig2.table[<span class="op">!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Affinity.Fup.Med)<span class="op">&amp;</span>Fig2.table<span class="op">$</span>Uncertain2<span class="op">==</span><span class="st">&quot;No&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]&lt;-<span class="st">&quot;No&quot;</span></a>
<a class="sourceLine" id="cb80-7" title="7">Fig2.table[Fig2.table<span class="op">$</span>TopFail<span class="op">==</span><span class="st">&quot;No&quot;</span><span class="op">&amp;!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Base.Fup.Med)<span class="op">&amp;</span>Fig2.table<span class="op">$</span>Uncertain<span class="op">==</span><span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]&lt;-<span class="st">&quot;Single Conc. Only&quot;</span></a>
<a class="sourceLine" id="cb80-8" title="8">Fig2.table[<span class="op">!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Affinity.Fup.Med)<span class="op">&amp;</span>Fig2.table<span class="op">$</span>Uncertain2<span class="op">==</span><span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;TopFail&quot;</span>]&lt;-<span class="st">&quot;Yes&quot;</span></a>
<a class="sourceLine" id="cb80-9" title="9">Fig2.table[<span class="op">!</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Affinity.Fup.Med)<span class="op">&amp;</span><span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Base.Fup.Med),<span class="st">&quot;TopFail&quot;</span>] &lt;-<span class="st"> &quot;Single Conc. Only&quot;</span></a>
<a class="sourceLine" id="cb80-10" title="10">Fig2.table[<span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Base.Fup.Med),<span class="st">&quot;Base.Fup.Med&quot;</span>] &lt;-<span class="st">  </span>Fig2.table[<span class="kw">is.na</span>(Fig2.table<span class="op">$</span>Base.Fup.Med),<span class="st">&quot;Affinity.Fup.Med&quot;</span>]</a>
<a class="sourceLine" id="cb80-11" title="11"></a>
<a class="sourceLine" id="cb80-12" title="12"></a>
<a class="sourceLine" id="cb80-13" title="13">Fig2b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med)),<span class="kw">aes</span>(<span class="dt">x=</span>Base.Fup.Med,<span class="dt">y=</span>Affinity.Fup.Med,<span class="dt">shape=</span>TopFail,<span class="dt">alpha=</span>TopFail,<span class="dt">colour=</span>TopFail)) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-14" title="14"><span class="st">         </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb80-15" title="15"><span class="st">         </span><span class="kw">geom_point</span>(<span class="dt">data=</span><span class="kw">subset</span>(Fig2.table,TopFail<span class="op">==</span><span class="st">&quot;No&quot;</span>),<span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb80-16" title="16"><span class="co">#         geom_errorbar(aes(ymax = Fup.High.x, ymin=Fup.Low.x))+</span></a>
<a class="sourceLine" id="cb80-17" title="17"><span class="co">#         geom_errorbarh(aes(xmin=Fup.Low.y,xmax=Fup.High.y))+</span></a>
<a class="sourceLine" id="cb80-18" title="18"><span class="st">   </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-19" title="19"><span class="st">   </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>,<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-20" title="20"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Single Conc.)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-21" title="21"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(F[up],<span class="st">&quot; Bayesian Analysis (Three Conc.)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-22" title="22"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;Blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb80-23" title="23"><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Uncertain&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb80-24" title="24"><span class="st">  </span><span class="kw">scale_shape_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Uncertain&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-25" title="25"><span class="co">#    annotate(&quot;text&quot;,size=8, x = 10^-4, y = 1, label = &quot;B&quot;)+</span></a>
<a class="sourceLine" id="cb80-26" title="26"><span class="st">   </span><span class="kw">scale_alpha_manual</span>(<span class="dt">name=</span><span class="st">&quot;Uncertain&quot;</span>,<span class="dt">values=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.6</span>,<span class="fl">0.3</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb80-27" title="27"><span class="st">     </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb80-28" title="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb80-29" title="29"><span class="st">      </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>, <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">label =</span> <span class="st">&quot;b&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb80-30" title="30"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">alpha=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dt">shape=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb80-31" title="31">         </a>
<a class="sourceLine" id="cb80-32" title="32"><span class="co">#print(Fig2b)</span></a>
<a class="sourceLine" id="cb80-33" title="33"></a>
<a class="sourceLine" id="cb80-34" title="34"><span class="co"># Need to reduce to unique chemicals.</span></a>
<a class="sourceLine" id="cb80-35" title="35">Fupbaseworked &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Base.Fup.Med)<span class="op">&amp;</span>Uncertain<span class="op">==</span><span class="st">&quot;No&quot;</span>)</a>
<a class="sourceLine" id="cb80-36" title="36">Fupbasenot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Base.Fup.Med)<span class="op">&amp;</span>Uncertain<span class="op">==</span><span class="st">&quot;Yes&quot;</span>)</a>
<a class="sourceLine" id="cb80-37" title="37">Fupbaseworked &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupbaseworked,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb80-38" title="38">Fupbasenot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupbasenot,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb80-39" title="39"><span class="co"># Also need to count a chemical as a success if it worked for either duplicate:</span></a>
<a class="sourceLine" id="cb80-40" title="40">Fupbasenot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupbasenot,<span class="op">!</span>(CAS<span class="op">%in%</span>Fupbaseworked<span class="op">$</span>CAS))</a>
<a class="sourceLine" id="cb80-41" title="41"></a>
<a class="sourceLine" id="cb80-42" title="42">Fupaffinityworked &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med)<span class="op">&amp;</span>Uncertain2<span class="op">==</span><span class="st">&quot;No&quot;</span>)</a>
<a class="sourceLine" id="cb80-43" title="43">Fupaffinitynot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Affinity.Fup.Med)<span class="op">&amp;</span>Uncertain2<span class="op">==</span><span class="st">&quot;Yes&quot;</span>)</a>
<a class="sourceLine" id="cb80-44" title="44">Fupaffinityworked &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupaffinityworked,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb80-45" title="45">Fupaffinitynot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupaffinitynot,<span class="op">!</span><span class="kw">duplicated</span>(CAS))</a>
<a class="sourceLine" id="cb80-46" title="46">Fupaffinitynot &lt;-<span class="st"> </span><span class="kw">subset</span>(Fupaffinitynot,<span class="op">!</span>(CAS<span class="op">%in%</span>Fupaffinityworked<span class="op">$</span>CAS))</a>
<a class="sourceLine" id="cb80-47" title="47"></a>
<a class="sourceLine" id="cb80-48" title="48"></a>
<a class="sourceLine" id="cb80-49" title="49"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">dim</span>(Fupbaseworked)[<span class="dv">1</span>],<span class="st">&quot;total successful Fup estimates using single conc.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;234 total successful Fup estimates using single conc.&quot;</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">signif</span>(<span class="kw">dim</span>(Fupbasenot)[<span class="dv">1</span>]<span class="op">/</span>(<span class="kw">dim</span>(Fupbaseworked)[<span class="dv">1</span>]<span class="op">+</span><span class="kw">dim</span>(Fupbasenot)[<span class="dv">1</span>])<span class="op">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;percent failure rate using single conc.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;44 percent failure rate using single conc.&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">dim</span>(Fupaffinityworked)[<span class="dv">1</span>],<span class="st">&quot;total successful Fup estimates using protein titration.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;380 total successful Fup estimates using protein titration.&quot;</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">signif</span>(<span class="kw">dim</span>(Fupaffinitynot)[<span class="dv">1</span>]<span class="op">/</span>(<span class="kw">dim</span>(Fupaffinityworked)[<span class="dv">1</span>]<span class="op">+</span><span class="kw">dim</span>(Fupaffinitynot)[<span class="dv">1</span>])<span class="op">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;percent failure rate using protein titration.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;9.09 percent failure rate using protein titration.&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">dim</span>(Fupbasenot)[<span class="dv">1</span>],<span class="st">&quot;uncertain estimates using original protocol.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;184 uncertain estimates using original protocol.&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">dim</span>(Fupaffinitynot)[<span class="dv">1</span>],<span class="st">&quot;uncertain estimates using protein titration.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;38 uncertain estimates using protein titration.&quot;</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">dim</span>(Fupaffinityworked)[<span class="dv">1</span>]<span class="op">-</span><span class="kw">dim</span>(Fupbaseworked)[<span class="dv">1</span>],<span class="st">&quot;chemicals that could not be measured at 100% plasma protein.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;146 chemicals that could not be measured at 100% plasma protein.&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">Wetmore.data &lt;-<span class="st"> </span>httk<span class="op">:::</span>Wetmore.data</a>
<a class="sourceLine" id="cb94-2" title="2">W2015 &lt;-<span class="st"> </span><span class="kw">subset</span>(Wetmore.data,Reference<span class="op">==</span><span class="st">&quot;Wetmore 2015&quot;</span>)</a>
<a class="sourceLine" id="cb94-3" title="3"></a>
<a class="sourceLine" id="cb94-4" title="4">W2012 &lt;-<span class="st"> </span><span class="kw">subset</span>(Wetmore.data,Reference<span class="op">==</span><span class="st">&quot;Wetmore 2012&quot;</span>)</a>
<a class="sourceLine" id="cb94-5" title="5"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The Fup assay failed for &quot;</span>,<span class="kw">signif</span>(<span class="kw">sum</span>(W2012<span class="op">$</span>Fub<span class="op">==</span><span class="fl">0.005</span>)<span class="op">/</span><span class="kw">length</span>(W2012<span class="op">$</span>Fub)<span class="op">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;% of chemicals in {Wetmore, 2012} and &quot;</span>,<span class="kw">signif</span>(<span class="kw">sum</span>(W2015<span class="op">$</span>Fub<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span><span class="kw">length</span>(W2015<span class="op">$</span>Fub)<span class="op">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;% of chemicals in {Wetmore, 2015}.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;The Fup assay failed for  38.6 % of chemicals in {Wetmore, 2012} and  11.5 % of chemicals in {Wetmore, 2015}.&quot;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">Fuplod &lt;-<span class="st"> </span><span class="kw">subset</span>(Fig2.table,TopFail<span class="op">==</span><span class="st">&quot;Single Conc. Only&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Among the chemicals that were uncertain using the original protocol but could be measured using the new three concentration protocol, the median estimated Fup was &quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(Fuplod<span class="op">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;with values as low as &quot;</span>,<span class="kw">signif</span>(<span class="kw">min</span>(Fuplod<span class="op">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;and as high as&quot;</span>,<span class="kw">signif</span>(<span class="kw">max</span>(Fuplod<span class="op">$</span>Affinity.Fup.Med),<span class="dv">2</span>),<span class="st">&quot;. Previously, a default of 0.005 has been assumed when Fup could not be measured {Rotroff, 2010}.}&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;Among the chemicals that were uncertain using the original protocol but could be measured using the new three concentration protocol, the median estimated Fup was  0.0041 with values as low as  9.5e-09 and as high as 0.95 . Previously, a default of 0.005 has been assumed when Fup could not be measured {Rotroff, 2010}.}&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(Fig2.table,<span class="op">!</span><span class="kw">is.na</span>(Base.Fup.Med)<span class="op">&amp;</span>Affinity.Fup.Med<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;</span>Base.Fup.Med<span class="op">&gt;</span><span class="dv">0</span>),<span class="kw">log</span>(Base.Fup.Med)<span class="op">~</span><span class="kw">log</span>(Affinity.Fup.Med)))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Base.Fup.Med) ~ log(Affinity.Fup.Med), data = subset(Fig2.table, 
##     !is.na(Base.Fup.Med) &amp; Affinity.Fup.Med &gt; 0 &amp; Base.Fup.Med &gt; 
##         0))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.8976 -0.4326  1.7346  2.2525 13.7985 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -2.56126    0.24997  -10.25   &lt;2e-16 ***
## log(Affinity.Fup.Med)  0.67769    0.03246   20.88   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.735 on 445 degrees of freedom
## Multiple R-squared:  0.4948, Adjusted R-squared:  0.4937 
## F-statistic: 435.8 on 1 and 445 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">dev.new</span>(<span class="dt">width=</span><span class="dv">10</span>,<span class="dt">height=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">multiplot</span>(Fig2a,Fig2b,<span class="dt">cols=</span><span class="dv">2</span>,<span class="dt">widths=</span><span class="kw">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</a></code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p>#Figure 3: Comparison of Bayesian fup and Uncertainty Estimations to Experimental Point Estimates. Two separate Bayesian analyses were performed: one including only those data collected at 100% PPP, and a second that used a binding model to relate data collected at 10%, 30%, and 100% PPP. In (A), fup point estimates &lt;0 are plotted on the y-axis. These values are considered “good” if they lie between 0 and 1. The Bayesian median fup values (x-axis) derived from the 100% PPP data and the associated uncertainty estimates (vertical lines) were correlated with point estimates. Bayesian model estimates were constrained to be greater than zero and less than 1;. The red dotted line (at 1%) represents a previously assumed generic limit of quantification (Wetmore, et al., 2015; Wetmore, et al., 2012). In (B), the medians from the two Bayesian analyses are compared. In both plots, the diagonal dashed line indicates the identity line (“perfect predictions”). In both panels the Bayesian estimates are “uncertain” (semi-solid) if the CV was larger than 0.5 and certain (solid) otherwise.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">Fig1.table<span class="op">$</span>Class &lt;-<span class="st"> &quot;Other&quot;</span></a>
<a class="sourceLine" id="cb104-2" title="2">Fig1.table[Fig1.table<span class="op">$</span>DTXSID <span class="op">%in%</span><span class="st"> </span>pharma<span class="op">$</span>DTXSID,<span class="st">&quot;Class&quot;</span>]&lt;-<span class="st">&quot;Pharmaceutical&quot;</span></a>
<a class="sourceLine" id="cb104-3" title="3">Fig1.table<span class="op">$</span>Class &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Fig1.table<span class="op">$</span>Class)</a>
<a class="sourceLine" id="cb104-4" title="4"></a>
<a class="sourceLine" id="cb104-5" title="5">  Fig3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Fig1.table,<span class="kw">aes</span>(Affinity.Kd.Med,<span class="dt">fill=</span>Class))<span class="op">+</span></a>
<a class="sourceLine" id="cb104-6" title="6"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb104-7" title="7"><span class="st">    </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Binding Affinity (&quot;</span>, mu,<span class="st">&quot;M)&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-8" title="8"><span class="st">      </span><span class="kw">ylab</span>(<span class="st">&quot;Number of chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb104-9" title="9"><span class="st">    </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb104-10" title="10"><span class="st">      </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Chemical Class&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb104-11" title="11"><span class="st">      </span><span class="kw">theme_bw</span>()  <span class="op">+</span></a>
<a class="sourceLine" id="cb104-12" title="12"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>))</a>
<a class="sourceLine" id="cb104-13" title="13">      </a>
<a class="sourceLine" id="cb104-14" title="14">  <span class="kw">dev.new</span>()</a>
<a class="sourceLine" id="cb104-15" title="15">  <span class="kw">print</span>(Fig3)</a></code></pre></div>
<pre><code>## Warning: Removed 83 rows containing non-finite values (stat_bin).</code></pre>
<p>#Figure 4: Comparison of Bayesian Clint and Uncertainty Estimations to Experimental Point Estimates. Clint estimate for 1 µM chemical concentration displayed, though 1 and 10 µM were fit jointly. The size of the credible interval varies significantly from chemical to chemical, especially for the lower clearance rates. Plots of individual fits are provided as supplemental material <!-- (https://doi.org/10.5061/dryad.nf40jb4) -->.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">clearance.table &lt;-<span class="st"> </span><span class="kw">subset</span>(httk<span class="op">::</span>wambaugh2019.raw,<span class="op">!</span><span class="kw">is.na</span>(CLint<span class="fl">.1</span>uM.Median))</a>
<a class="sourceLine" id="cb106-2" title="2">    </a>
<a class="sourceLine" id="cb106-3" title="3"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">==</span><span class="dv">0</span>),<span class="st">&quot;zero valued median Bayesian posteriors&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;142 zero valued median Bayesian posteriors&quot;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point<span class="op">==</span><span class="dv">0</span><span class="op">&amp;</span>clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">&gt;</span><span class="dv">0</span>,<span class="dt">na.rm=</span>T),<span class="st">&quot;zero valued point estimates where median posterior&gt;0&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;43 zero valued point estimates where median posterior&gt;0&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;</span>clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">==</span><span class="dv">0</span>,<span class="dt">na.rm=</span>T),<span class="st">&quot;zero valued median Bayesian posteriors where point estimate was non-zero&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;17 zero valued median Bayesian posteriors where point estimate was non-zero&quot;</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point)<span class="op">&amp;</span>clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">==</span><span class="dv">0</span>,<span class="dt">na.rm=</span>T),<span class="st">&quot;zero valued median Bayesian posteriors where point estimate was NA&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;5 zero valued median Bayesian posteriors where point estimate was NA&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point)<span class="op">&amp;</span>clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">&gt;</span><span class="dv">0</span>,<span class="dt">na.rm=</span>T),<span class="st">&quot;non-zero valued median Bayesian posteriors where point estimate was NA&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;29 non-zero valued median Bayesian posteriors where point estimate was NA&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">clearance.table<span class="op">$</span>Fit &lt;-<span class="st"> &quot;Decreasing&quot;</span></a>
<a class="sourceLine" id="cb116-2" title="2">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,<span class="st">&quot;Fit&quot;</span>] &lt;-<span class="st"> &quot;Median Zero&quot;</span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="co">#clearance.table[is.na(clearance.table$CLint.1uM.Point == 0),&quot;Fit&quot;] &lt;- &quot;Point Est. Missing&quot;</span></a>
<a class="sourceLine" id="cb116-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(clearance.table)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb116-5" title="5">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.na</span>(clearance.table[i,<span class="st">&quot;CLint.1uM.Point&quot;</span>]))</a>
<a class="sourceLine" id="cb116-6" title="6">  {</a>
<a class="sourceLine" id="cb116-7" title="7">    <span class="cf">if</span> (clearance.table[i,<span class="st">&quot;CLint.1uM.Point&quot;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) clearance.table[i,<span class="st">&quot;Fit&quot;</span>] &lt;-<span class="st"> &quot;Point Est. Zero&quot;</span></a>
<a class="sourceLine" id="cb116-8" title="8">  } <span class="cf">else</span> clearance.table[i,<span class="st">&quot;Fit&quot;</span>] &lt;-<span class="st"> &quot;Point Est. Failed&quot;</span></a>
<a class="sourceLine" id="cb116-9" title="9">   </a>
<a class="sourceLine" id="cb116-10" title="10"></a>
<a class="sourceLine" id="cb116-11" title="11"><span class="kw">set.seed</span>(<span class="dv">123456</span>)</a>
<a class="sourceLine" id="cb116-12" title="12">clearance.table[<span class="kw">is.na</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point),<span class="st">&quot;CLint.1uM.Point&quot;</span>]&lt;-<span class="kw">runif</span>(<span class="kw">sum</span>(<span class="kw">is.na</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point)),<span class="fl">0.1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb116-13" title="13">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Point&quot;</span>]&lt;-<span class="kw">runif</span>(<span class="kw">sum</span>(clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Point<span class="op">==</span><span class="dv">0</span>),<span class="fl">0.3</span>,<span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb116-14" title="14">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Low95th<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Low95th&quot;</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb116-15" title="15">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Median<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.Median&quot;</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb116-16" title="16">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.High95th<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;CLint.1uM.High95th&quot;</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb116-17" title="17">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.High95th<span class="op">&gt;</span><span class="dv">1000</span>,<span class="st">&quot;CLint.1uM.High95th&quot;</span>]&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb116-18" title="18">clearance.table[clearance.table<span class="op">$</span>CLint<span class="fl">.1</span>uM.Low95th<span class="op">&lt;</span><span class="fl">0.1</span>,<span class="st">&quot;CLint.1uM.Low95th&quot;</span>]&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb116-19" title="19"></a>
<a class="sourceLine" id="cb116-20" title="20">clearance.fit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log10</span>(CLint<span class="fl">.1</span>uM.Median)<span class="op">~</span><span class="kw">log10</span>(CLint<span class="fl">.1</span>uM.Point),<span class="dt">data=</span><span class="kw">subset</span>(clearance.table,<span class="op">!</span><span class="kw">is.na</span>(CLint<span class="fl">.1</span>uM.Point)<span class="op">&amp;</span>CLint<span class="fl">.1</span>uM.Point<span class="op">&gt;</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb116-21" title="21">Fig4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(clearance.table, <span class="kw">aes</span>(<span class="dt">x=</span>CLint<span class="fl">.1</span>uM.Point,<span class="dt">y=</span>CLint<span class="fl">.1</span>uM.Median,<span class="dt">colour=</span>Fit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb116-22" title="22"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>CLint<span class="fl">.1</span>uM.Point,<span class="dt">xend=</span>CLint<span class="fl">.1</span>uM.Point,<span class="dt">y=</span>CLint<span class="fl">.1</span>uM.Low95th,<span class="dt">yend=</span>CLint<span class="fl">.1</span>uM.High95th),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb116-23" title="23"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb116-24" title="24"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">1000</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-25" title="25"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>_skip,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">1</span>,<span class="dv">1000</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb116-26" title="26"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(CL[int],<span class="st">&quot; (&quot;</span>,mu,<span class="st">&quot;L/min/&quot;</span>,<span class="dv">10</span><span class="op">^</span>{<span class="dv">6</span>},<span class="st">&quot; Hep.) Point Estimate&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb116-27" title="27"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(CL[int],<span class="st">&quot; (&quot;</span>,mu,<span class="st">&quot;L/min/&quot;</span>,<span class="dv">10</span><span class="op">^</span>{<span class="dv">6</span>},<span class="st">&quot; Hep.) Bayesian&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb116-28" title="28"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.25</span>, <span class="dt">size=</span><span class="dv">2</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb116-29" title="29"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.9</span>, <span class="dt">size=</span><span class="dv">2</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb116-30" title="30"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb116-31" title="31"><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Assay Result&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb116-32" title="32"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb116-33" title="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb116-34" title="34"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb116-35" title="35"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">x =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">0</span>,<span class="dt">size=</span><span class="dv">6</span>, <span class="dt">label =</span> <span class="kw">lm_R2</span>(clearance.fit,<span class="dt">prefix=</span><span class="st">&quot;&quot;</span>),<span class="dt">parse=</span>T)</a>
<a class="sourceLine" id="cb116-36" title="36"></a>
<a class="sourceLine" id="cb116-37" title="37"><span class="kw">dev.new</span>()</a>
<a class="sourceLine" id="cb116-38" title="38"><span class="kw">print</span>(Fig4)  </a></code></pre></div>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Removed 18 rows containing missing values (geom_segment).</code></pre>
<pre><code>## Warning: Removed 19 rows containing missing values (geom_point).</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">summary</span>(clearance.fit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log10(CLint.1uM.Median) ~ log10(CLint.1uM.Point), 
##     data = subset(clearance.table, !is.na(CLint.1uM.Point) &amp; 
##         CLint.1uM.Point &gt; 1))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.23202 -0.13045  0.03545  0.23748  1.43240 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            -0.63854    0.10118  -6.311 1.14e-09 ***
## log10(CLint.1uM.Point)  1.40787    0.06718  20.958  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5416 on 269 degrees of freedom
## Multiple R-squared:  0.6202, Adjusted R-squared:  0.6188 
## F-statistic: 439.2 on 1 and 269 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>#Figure 5: Figure 5. Uncertainty Assessment for TK Quantities half-life and Css. The impact of uncertainty on estimated values for fup and Clint could in turn affect additional TK quantities, for example elimination half-life (t1/2, shown in panel A) and steady-state serum concentration (Css, shown in panel B). In both plots, the x-axis indicates the value that would have been estimated with previous methods, while the y-axis indicates the median and 95% credible interval for values calculated with our Bayesian method. Chemicals plotted with triangles are those that could be estimated with the previous, point estimate methods, while chemicals plotted with circles could not. The dashed line indicates the identity (perfect predictor) line. Chemicals that had no point estimate are plotted on the identity line.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="co"># This section takes a long time because calc_vdist is not yet data.table compatible:</span></a>
<a class="sourceLine" id="cb127-2" title="2">ceetox &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(<span class="kw">subset</span>(httk<span class="op">::</span>wambaugh2019,<span class="op">!</span><span class="kw">is.na</span>(Human.Funbound.plasma)<span class="op">&amp;!</span><span class="kw">is.na</span>(Human.Clint)<span class="op">&amp;!</span><span class="kw">is.na</span>(logP)))</a>
<a class="sourceLine" id="cb127-3" title="3">httk_cas &lt;-<span class="st"> </span>ceetox<span class="op">$</span>CAS[ceetox<span class="op">$</span>CAS <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&quot;3compartmentss&quot;</span>)]</a>
<a class="sourceLine" id="cb127-4" title="4"></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="co"># back up chem.physical_and_invtro.data:</span></a>
<a class="sourceLine" id="cb127-6" title="6">HTTK.data &lt;-<span class="st"> </span>chem.physical_and_invitro.data</a>
<a class="sourceLine" id="cb127-7" title="7"></a>
<a class="sourceLine" id="cb127-8" title="8"><span class="co"># Use the point estimates:</span></a>
<a class="sourceLine" id="cb127-9" title="9">chem.physical_and_invitro.data &lt;-<span class="st"> </span><span class="kw">add_chemtable</span>(httk<span class="op">::</span>wambaugh2019.raw,<span class="dt">current.table=</span>chem.physical_and_invitro.data,<span class="dt">data.list=</span><span class="kw">list</span>(<span class="dt">Compound=</span><span class="st">&quot;Name&quot;</span>,<span class="dt">CAS=</span><span class="st">&quot;CAS&quot;</span>,<span class="dt">Clint=</span><span class="st">&quot;CLint.1uM.Point&quot;</span>,<span class="dt">Funbound.plasma=</span><span class="st">&quot;Fup.point&quot;</span>),<span class="dt">reference=</span><span class="st">&quot;Wambaugh 2019&quot;</span>,<span class="dt">species=</span><span class="st">&quot;Human&quot;</span>,<span class="dt">overwrite=</span>T)</a>
<a class="sourceLine" id="cb127-10" title="10"></a>
<a class="sourceLine" id="cb127-11" title="11"></a>
<a class="sourceLine" id="cb127-12" title="12"></a>
<a class="sourceLine" id="cb127-13" title="13">schmitt_cas &lt;-<span class="st"> </span>httk_cas[httk_cas <span class="op">%in%</span><span class="st"> </span><span class="kw">get_cheminfo</span>(<span class="dt">model=</span><span class="st">&quot;schmitt&quot;</span>)]       </a>
<a class="sourceLine" id="cb127-14" title="14">ceetox[CAS<span class="op">%in%</span>schmitt_cas,</a>
<a class="sourceLine" id="cb127-15" title="15">       hlpoint<span class="op">:</span><span class="er">=</span><span class="kw">log</span>(<span class="dv">2</span>)<span class="op">/</span>httk<span class="op">::</span><span class="kw">calc_elimination_rate</span>(<span class="dt">chem.cas=</span>CAS),</a>
<a class="sourceLine" id="cb127-16" title="16">       by=.(CAS)]</a>
<a class="sourceLine" id="cb127-17" title="17">       </a>
<a class="sourceLine" id="cb127-18" title="18">chem.physical_and_invitro.data &lt;-<span class="st"> </span>HTTK.data</a>
<a class="sourceLine" id="cb127-19" title="19"></a>
<a class="sourceLine" id="cb127-20" title="20">ceetox[CAS<span class="op">%in%</span>schmitt_cas,</a>
<a class="sourceLine" id="cb127-21" title="21">       hl_<span class="dv">975</span><span class="op">:</span><span class="er">=</span><span class="kw">hlfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb127-22" title="22">                          <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb127-23" title="23">                          <span class="dt">probs=</span><span class="fl">0.975</span>),</a>
<a class="sourceLine" id="cb127-24" title="24">       by=.(CAS)]</a>
<a class="sourceLine" id="cb127-25" title="25"></a>
<a class="sourceLine" id="cb127-26" title="26">ceetox[CAS<span class="op">%in%</span>schmitt_cas,</a>
<a class="sourceLine" id="cb127-27" title="27">       hl_med<span class="op">:</span><span class="er">=</span><span class="kw">hlfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb127-28" title="28">                          <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb127-29" title="29">                          <span class="dt">probs=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb127-30" title="30">       by=.(CAS)]</a>
<a class="sourceLine" id="cb127-31" title="31">       </a>
<a class="sourceLine" id="cb127-32" title="32">ceetox[CAS<span class="op">%in%</span>schmitt_cas,</a>
<a class="sourceLine" id="cb127-33" title="33">       hl_<span class="dv">25</span><span class="op">:</span><span class="er">=</span><span class="kw">hlfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb127-34" title="34">                         <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb127-35" title="35">                          <span class="dt">probs=</span><span class="fl">0.025</span>),</a>
<a class="sourceLine" id="cb127-36" title="36">       by=.(CAS)]</a>
<a class="sourceLine" id="cb127-37" title="37"></a>
<a class="sourceLine" id="cb127-38" title="38">ceetox[,hlpointEstimated<span class="op">:</span><span class="er">=</span>T]</a>
<a class="sourceLine" id="cb127-39" title="39">ceetox[<span class="kw">is.na</span>(hlpoint),hlpointEstimated<span class="op">:</span><span class="er">=</span>F]</a>
<a class="sourceLine" id="cb127-40" title="40">ceetox[<span class="kw">is.na</span>(hlpoint),hlpoint<span class="op">:</span><span class="er">=</span>hl_med]</a>
<a class="sourceLine" id="cb127-41" title="41"></a>
<a class="sourceLine" id="cb127-42" title="42">hlfit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span><span class="kw">subset</span>(ceetox,hlpointEstimated),<span class="kw">log10</span>(hlpoint)<span class="op">~</span><span class="kw">log10</span>(hl_med))</a>
<a class="sourceLine" id="cb127-43" title="43">Fig5a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw">subset</span>(ceetox,hlpointEstimated),<span class="kw">aes</span>(<span class="dt">x=</span>hlpoint,<span class="dt">y=</span>hl_med)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-44" title="44"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-45" title="45"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> hl_<span class="dv">975</span>, <span class="dt">ymin=</span>hl_<span class="dv">25</span>),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-46" title="46"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-47" title="47"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-48" title="48"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;half-life (h) Point Estimate&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-49" title="49"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Bayesian half-life (h)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-50" title="50"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-51" title="51"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>, <span class="dt">label =</span> <span class="st">&quot;A&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-52" title="52"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb127-53" title="53"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb127-54" title="54"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">x =</span> <span class="dv">3</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">0</span>,<span class="dt">size=</span><span class="dv">5</span>, <span class="dt">label =</span> <span class="kw">lm_R2</span>(hlfit,<span class="dt">prefix=</span><span class="st">&quot;&quot;</span>),<span class="dt">parse=</span>T) </a>
<a class="sourceLine" id="cb127-55" title="55"></a>
<a class="sourceLine" id="cb127-56" title="56"></a>
<a class="sourceLine" id="cb127-57" title="57">cssfit &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ceetox,<span class="kw">log10</span>(cssmed)<span class="op">~</span><span class="kw">log10</span>(cssmed_u))</a>
<a class="sourceLine" id="cb127-58" title="58">Fig5b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>ceetox,<span class="kw">aes</span>(<span class="dt">x=</span>cssmed,<span class="dt">y=</span>cssmed_u)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-59" title="59"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-60" title="60"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>css25_u,<span class="dt">ymax=</span>css975_u),<span class="dt">alpha=</span><span class="fl">0.3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-61" title="61"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-62" title="62"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-63" title="63"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(C[ss],<span class="st">&quot; Point Estimate (µM)&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb127-64" title="64"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Bayesian &quot;</span>,C[ss],<span class="st">&quot; (µM)&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb127-65" title="65"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">5</span>, <span class="dt">label =</span> <span class="st">&quot;B&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-66" title="66"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb127-67" title="67"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text  =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-68" title="68"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb127-69" title="69"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="dt">x =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">10</span><span class="op">^-</span><span class="dv">3</span>,<span class="dt">size=</span><span class="dv">5</span>, <span class="dt">label =</span> <span class="kw">lm_R2</span>(cssfit,<span class="dt">prefix=</span><span class="st">&quot;&quot;</span>),<span class="dt">parse=</span>T)  </a>
<a class="sourceLine" id="cb127-70" title="70"></a>
<a class="sourceLine" id="cb127-71" title="71"></a>
<a class="sourceLine" id="cb127-72" title="72"><span class="kw">dev.new</span>(<span class="dt">width=</span><span class="dv">8</span>,<span class="dt">height=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb127-73" title="73"><span class="kw">multiplot</span>(Fig5a,Fig5b,<span class="dt">cols=</span><span class="dv">2</span>,<span class="dt">widths=</span><span class="kw">c</span>(<span class="fl">1.75</span>,<span class="fl">1.75</span>))</a></code></pre></div>
<p>#Figure 6: Relative contributions of uncertainty and variability to differences between the 95th percentile and median Css. Monte Carlo analysis of both variability (triangles) and uncertainty (circles) give distributions that can be characterized by a 95th percentile Css for which individuals achieve a higher Css for the same fixed dose rate – these individuals can be considered more “sensitive” to chemical exposure. Uncertainty and variability can be combined (squares) to estimate a 95th percentile reflecting both factors. For most chemicals, variability contributes more than uncertainty to the difference between the Css predicted for the median Clint and fup values.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb128-2" title="2">ceetox[CAS<span class="op">%in%</span>httk_cas,</a>
<a class="sourceLine" id="cb128-3" title="3">       css95_uv<span class="op">:</span><span class="er">=</span><span class="kw">calc_mc_css</span>(<span class="dt">chem.cas=</span>CAS,</a>
<a class="sourceLine" id="cb128-4" title="4">                                 <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>, <span class="co">#Don&#39;t need to use p-values here (Bayesian)</span></a>
<a class="sourceLine" id="cb128-5" title="5">                                 <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb128-6" title="6">                                 <span class="dt">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</a>
<a class="sourceLine" id="cb128-7" title="7">                                 <span class="dt">species=</span><span class="st">&quot;Human&quot;</span>),</a>
<a class="sourceLine" id="cb128-8" title="8">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-9" title="9">      </a>
<a class="sourceLine" id="cb128-10" title="10"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb128-11" title="11">ceetox[CAS<span class="op">%in%</span>httk_cas,    </a>
<a class="sourceLine" id="cb128-12" title="12">       css95_v<span class="op">:</span><span class="er">=</span><span class="kw">calc_mc_css</span>(<span class="dt">chem.cas=</span>CAS,</a>
<a class="sourceLine" id="cb128-13" title="13">                                 <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>, <span class="co">#Don&#39;t need to use p-values here (Bayesian)</span></a>
<a class="sourceLine" id="cb128-14" title="14">                                 <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb128-15" title="15">                                 <span class="dt">clint.meas.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb128-16" title="16">                                 <span class="dt">fup.meas.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb128-17" title="17">                                 <span class="dt">clint.pop.cv=</span><span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb128-18" title="18">                                 <span class="dt">fup.pop.cv=</span><span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb128-19" title="19">                                 <span class="dt">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</a>
<a class="sourceLine" id="cb128-20" title="20">                                 <span class="dt">species=</span><span class="st">&quot;Human&quot;</span>),</a>
<a class="sourceLine" id="cb128-21" title="21">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-22" title="22"></a>
<a class="sourceLine" id="cb128-23" title="23">       </a>
<a class="sourceLine" id="cb128-24" title="24"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb128-25" title="25">ceetox[CAS<span class="op">%in%</span>httk_cas, </a>
<a class="sourceLine" id="cb128-26" title="26">       css95_u<span class="op">:</span><span class="er">=</span><span class="kw">cssfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb128-27" title="27">                          <span class="dt">MW=</span>MW),</a>
<a class="sourceLine" id="cb128-28" title="28">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-29" title="29"></a>
<a class="sourceLine" id="cb128-30" title="30"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb128-31" title="31">ceetox[CAS<span class="op">%in%</span>httk_cas, </a>
<a class="sourceLine" id="cb128-32" title="32">       cssmed_u<span class="op">:</span><span class="er">=</span><span class="kw">cssfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb128-33" title="33">                          <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb128-34" title="34">                          <span class="dt">probs=</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb128-35" title="35">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-36" title="36">       </a>
<a class="sourceLine" id="cb128-37" title="37"><span class="kw">set.seed</span>(<span class="dv">42</span>)       </a>
<a class="sourceLine" id="cb128-38" title="38">ceetox[CAS<span class="op">%in%</span>httk_cas, </a>
<a class="sourceLine" id="cb128-39" title="39">       css25_u<span class="op">:</span><span class="er">=</span><span class="kw">cssfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb128-40" title="40">                          <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb128-41" title="41">                          <span class="dt">probs=</span><span class="fl">0.025</span>),</a>
<a class="sourceLine" id="cb128-42" title="42">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-43" title="43">       </a>
<a class="sourceLine" id="cb128-44" title="44"><span class="kw">set.seed</span>(<span class="dv">42</span>)       </a>
<a class="sourceLine" id="cb128-45" title="45">ceetox[CAS<span class="op">%in%</span>httk_cas, </a>
<a class="sourceLine" id="cb128-46" title="46">       css975_u<span class="op">:</span><span class="er">=</span><span class="kw">cssfun_u</span>(<span class="dt">chemcas=</span>CAS, </a>
<a class="sourceLine" id="cb128-47" title="47">                          <span class="dt">MW=</span>MW,</a>
<a class="sourceLine" id="cb128-48" title="48">                          <span class="dt">probs=</span><span class="fl">0.975</span>),</a>
<a class="sourceLine" id="cb128-49" title="49">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-50" title="50">       </a>
<a class="sourceLine" id="cb128-51" title="51">ceetox[CAS<span class="op">%in%</span>httk_cas, </a>
<a class="sourceLine" id="cb128-52" title="52">       cssmed<span class="op">:</span><span class="er">=</span>httk<span class="op">::</span><span class="kw">calc_analytic_css</span>(<span class="dt">chem.cas=</span>CAS,</a>
<a class="sourceLine" id="cb128-53" title="53">                                 <span class="dt">clint.pvalue.threshold=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb128-54" title="54">                                 <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>,</a>
<a class="sourceLine" id="cb128-55" title="55">                                 <span class="dt">model=</span><span class="st">&quot;3compartmentss&quot;</span>,</a>
<a class="sourceLine" id="cb128-56" title="56">                                 <span class="dt">species=</span><span class="st">&quot;Human&quot;</span>,</a>
<a class="sourceLine" id="cb128-57" title="57">                                 <span class="dt">suppress.messages=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb128-58" title="58">       by=.(CAS)]</a>
<a class="sourceLine" id="cb128-59" title="59"></a>
<a class="sourceLine" id="cb128-60" title="60"></a>
<a class="sourceLine" id="cb128-61" title="61"></a>
<a class="sourceLine" id="cb128-62" title="62"><span class="co"># Go back to Bayes estimates:</span></a>
<a class="sourceLine" id="cb128-63" title="63">chem.physical_and_invitro.data &lt;-<span class="st"> </span>HTTK.data</a>
<a class="sourceLine" id="cb128-64" title="64"></a>
<a class="sourceLine" id="cb128-65" title="65">dt_melt &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">melt</span>(ceetox[, .(Compound, CAS, css95_u, css95_v, css95_uv, cssmed)],</a>
<a class="sourceLine" id="cb128-66" title="66">                            <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>, <span class="st">&quot;cssmed&quot;</span>),</a>
<a class="sourceLine" id="cb128-67" title="67">                            <span class="dt">variable.name=</span><span class="st">&quot;type&quot;</span>,</a>
<a class="sourceLine" id="cb128-68" title="68">                            <span class="dt">value.name=</span><span class="st">&quot;css95&quot;</span>)</a>
<a class="sourceLine" id="cb128-69" title="69"></a>
<a class="sourceLine" id="cb128-70" title="70">dt_melt[, type<span class="op">:</span><span class="er">=</span><span class="kw">gsub</span>(<span class="dt">x=</span>type, <span class="dt">pattern=</span><span class="st">&quot;css95_uv&quot;</span>, <span class="dt">replacement=</span><span class="st">&quot;Both&quot;</span>, <span class="dt">fixed=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb128-71" title="71">dt_melt[, type<span class="op">:</span><span class="er">=</span><span class="kw">gsub</span>(<span class="dt">x=</span>type, <span class="dt">pattern=</span><span class="st">&quot;css95_u&quot;</span>, <span class="dt">replacement=</span><span class="st">&quot;Uncertainty&quot;</span>, <span class="dt">fixed=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb128-72" title="72">dt_melt[, type<span class="op">:</span><span class="er">=</span><span class="kw">gsub</span>(<span class="dt">x=</span>type, <span class="dt">pattern=</span><span class="st">&quot;css95_v&quot;</span>, <span class="dt">replacement=</span><span class="st">&quot;Variability&quot;</span>, <span class="dt">fixed=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb128-73" title="73"></a>
<a class="sourceLine" id="cb128-74" title="74"></a>
<a class="sourceLine" id="cb128-75" title="75"><span class="co">#now set the factor levels explicitly</span></a>
<a class="sourceLine" id="cb128-76" title="76">dt_melt[, type<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(type,</a>
<a class="sourceLine" id="cb128-77" title="77">                       <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Uncertainty&quot;</span>, <span class="st">&quot;Variability&quot;</span>, <span class="st">&quot;Both&quot;</span>))]</a>
<a class="sourceLine" id="cb128-78" title="78"></a>
<a class="sourceLine" id="cb128-79" title="79"></a>
<a class="sourceLine" id="cb128-80" title="80">dt_melt[, Norm<span class="op">:</span><span class="er">=</span>css95<span class="op">/</span>cssmed]</a>
<a class="sourceLine" id="cb128-81" title="81"></a>
<a class="sourceLine" id="cb128-82" title="82"></a>
<a class="sourceLine" id="cb128-83" title="83"><span class="co">#now set the factor levels explicitly</span></a>
<a class="sourceLine" id="cb128-84" title="84">dt_melt[, Compound<span class="op">:</span><span class="er">=</span><span class="kw">factor</span>(Compound,</a>
<a class="sourceLine" id="cb128-85" title="85">                       <span class="dt">levels=</span>dt_melt[type<span class="op">==</span><span class="st">&quot;Both&quot;</span>,Compound][<span class="kw">order</span>(dt_melt[type<span class="op">==</span><span class="st">&quot;Both&quot;</span>,Norm])])]</a>
<a class="sourceLine" id="cb128-86" title="86">                       </a>
<a class="sourceLine" id="cb128-87" title="87">                       </a>
<a class="sourceLine" id="cb128-88" title="88">Fig6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>dt_melt) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-89" title="89"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">alpha=</span><span class="fl">0.7</span>,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,</a>
<a class="sourceLine" id="cb128-90" title="90">                <span class="dt">y=</span>Norm,</a>
<a class="sourceLine" id="cb128-91" title="91">                <span class="dt">color=</span>type,</a>
<a class="sourceLine" id="cb128-92" title="92">                <span class="dt">shape=</span>type)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-93" title="93"><span class="st">   </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits=</span><span class="kw">c</span>(<span class="fl">0.9</span>,<span class="dv">500</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-94" title="94"><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Ratio of &quot;</span>,C[ss],<span class="st">&quot; &quot;</span>,<span class="dv">95</span><span class="op">^</span>th,<span class="st">&quot; Percentile to Median Estimate&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-95" title="95"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Chemicals&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb128-96" title="96"><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(C[ss],<span class="st">&quot; Varied to Reflect&quot;</span>)))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb128-97" title="97"><span class="st">  </span><span class="kw">scale_shape_discrete</span>(<span class="dt">name=</span><span class="kw">expression</span>(<span class="kw">paste</span>(C[ss],<span class="st">&quot; Varied to Reflect&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-98" title="98"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb128-99" title="99"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>,<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb128-100" title="100"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="kw">levels</span>(dt_melt<span class="op">$</span>Compound)[<span class="kw">length</span>(<span class="kw">unique</span>(dt_melt<span class="op">$</span>Compound))<span class="op">/</span><span class="dv">2</span>], <span class="dt">y =</span> <span class="dv">400</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Median Ratio for Uncertainty:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(<span class="kw">subset</span>(dt_melt,type<span class="op">==</span><span class="st">&quot;Uncertainty&quot;</span>)<span class="op">$</span>Norm),<span class="dv">3</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb128-101" title="101"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="kw">levels</span>(dt_melt<span class="op">$</span>Compound)[<span class="kw">length</span>(<span class="kw">unique</span>(dt_melt<span class="op">$</span>Compound))<span class="op">/</span><span class="dv">2</span>], <span class="dt">y =</span> <span class="dv">200</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Median Ratio for Variability:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(<span class="kw">subset</span>(dt_melt,type<span class="op">==</span><span class="st">&quot;Variability&quot;</span>)<span class="op">$</span>Norm),<span class="dv">3</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb128-102" title="102"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="kw">levels</span>(dt_melt<span class="op">$</span>Compound)[<span class="kw">length</span>(<span class="kw">unique</span>(dt_melt<span class="op">$</span>Compound))<span class="op">/</span><span class="dv">2</span>], <span class="dt">y =</span> <span class="dv">100</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Median Ratio for Both:&quot;</span>,<span class="kw">signif</span>(<span class="kw">median</span>(<span class="kw">subset</span>(dt_melt,type<span class="op">==</span><span class="st">&quot;Both&quot;</span>)<span class="op">$</span>Norm),<span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb128-103" title="103">    </a>
<a class="sourceLine" id="cb128-104" title="104"><span class="kw">dev.new</span>(<span class="dt">width=</span><span class="dv">10</span>,<span class="dt">height=</span><span class="dv">6</span>)  </a>
<a class="sourceLine" id="cb128-105" title="105"><span class="kw">print</span>(Fig6)</a></code></pre></div>
<p>#Figure 7: High throughput risk-based prioritization can be conducted by using doses predicted to cause bioactivity identified by high throughput screening. High throughput exposure estimates have large uncertainty, indicated by the triangles (median of distribution) and vertical bar (upper 95th percentile range). There are many in vitro activities identified for each chemical, the 80% interval of equivalent dose rates is indicated by the vertical red bar, with a horizontal slash indicating the median and the circle plot points indicating the 10th percentile of the bioactive concentration. Anywhere the entire exposure bar is below the bioactivity circle there is 95% probability that the median exposure will not cause a dose sufficient to cause the 10th percentile in vitro bioactivity. Chemicals are sorted from left-to-right by the margin between the 10th percentile bioactivity (small circle) and the upper 95th percentile limit on estimated median intake rate. In panel A, all chemicals for which Css could be calculated are shown using only variability. In panel B, the shaded region of panel A is shown, using both variability and uncertainty to calculate the bioactive dose. Arrows in panel B identify six chemicals where exposure and 10th percentile bioactivity potentially overlap that would have been missed as priority chemicals if uncertainty analysis was not performed. Two overlapping bars are shown for each chemical’s bioactive doses – the upper one is for variability alone (as in Panel A), the lower is for uncertainty and variability together.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="co"># Head to ftp://newftp.epa.gov/COMPTOX/High_Throughput_Screening_Data/Previous_Data/ToxCast_Data_Release_Oct_2015/ to get the ToxCast/Tox21 data:</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="co"># These are the concentrations that caused activity in exess of the background (ACC) &quot;hits&quot;.</span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="co"># This has been Subset  to just the chemicals we have new numbers for:</span></a>
<a class="sourceLine" id="cb129-4" title="4"><span class="co">#Tox21.acc &lt;- httk::wambaugh2019.Tox21</span></a>
<a class="sourceLine" id="cb129-5" title="5"></a>
<a class="sourceLine" id="cb129-6" title="6"><span class="co"># We need to turn this into a data frame with a row for each hit:</span></a>
<a class="sourceLine" id="cb129-7" title="7"><span class="co">#Tox21.acc.rows &lt;- melt(Tox21.acc,id=c(&quot;code&quot;,&quot;chid&quot;,&quot;chnm&quot;,&quot;casn&quot;,&quot;clib&quot;))</span></a>
<a class="sourceLine" id="cb129-8" title="8"></a>
<a class="sourceLine" id="cb129-9" title="9"><span class="co"># Get rid of the NA&#39;s (non-hits):</span></a>
<a class="sourceLine" id="cb129-10" title="10"><span class="co">#Tox21.acc.numeric &lt;- subset(Tox21.acc.rows,!is.na(value))</span></a>
<a class="sourceLine" id="cb129-11" title="11"></a>
<a class="sourceLine" id="cb129-12" title="12"><span class="co"># In this vignette we use the AC50&#39;s (as in Ring 2017) rather than ACC&#39;s</span></a>
<a class="sourceLine" id="cb129-13" title="13"><span class="co"># (as in Wambaugh submitted) to help keep the HTTK package smaller:</span></a>
<a class="sourceLine" id="cb129-14" title="14">Tox21.acc.numeric &lt;-<span class="st"> </span>httk<span class="op">::</span>ToxCast2015subset[,<span class="kw">c</span>(<span class="st">&quot;Chemical.Name&quot;</span>,</a>
<a class="sourceLine" id="cb129-15" title="15">  <span class="st">&quot;CASRN&quot;</span>,</a>
<a class="sourceLine" id="cb129-16" title="16">  <span class="st">&quot;Assay.Endpoint&quot;</span>,</a>
<a class="sourceLine" id="cb129-17" title="17">  <span class="st">&quot;AC50&quot;</span>,</a>
<a class="sourceLine" id="cb129-18" title="18">  <span class="st">&quot;Activity.Call&quot;</span>)]</a>
<a class="sourceLine" id="cb129-19" title="19"><span class="kw">colnames</span>(Tox21.acc.numeric) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chnm&quot;</span>,<span class="st">&quot;casn&quot;</span>,<span class="st">&quot;variable&quot;</span>,<span class="st">&quot;value&quot;</span>,<span class="st">&quot;call&quot;</span>)</a>
<a class="sourceLine" id="cb129-20" title="20"></a>
<a class="sourceLine" id="cb129-21" title="21">chem.preds &lt;-<span class="st"> </span>httk<span class="op">::</span>wambaugh2019.seem3</a>
<a class="sourceLine" id="cb129-22" title="22">directnhanes.preds &lt;-<span class="st"> </span>httk<span class="op">::</span>wambaugh2019.nhanes</a>
<a class="sourceLine" id="cb129-23" title="23"></a>
<a class="sourceLine" id="cb129-24" title="24"><span class="co">#Subset to those chemicals with HTS hits:</span></a>
<a class="sourceLine" id="cb129-25" title="25">human.hits &lt;-<span class="st"> </span><span class="kw">subset</span>(ceetox,CAS<span class="op">%in%</span>Tox21.acc.numeric<span class="op">$</span>casn)</a>
<a class="sourceLine" id="cb129-26" title="26"></a>
<a class="sourceLine" id="cb129-27" title="27"></a>
<a class="sourceLine" id="cb129-28" title="28"><span class="co"># Now calculate the oral equivalent dose for each chemical:</span></a>
<a class="sourceLine" id="cb129-29" title="29"><span class="co"># VERY IMPORTANT -- MUST CHECK WHETHER VALUES IN THE ACC DATA FILE ARE LOG BASE E OR 10</span></a>
<a class="sourceLine" id="cb129-30" title="30"><span class="co"># Must make sure that CSS is in units of uM!!</span></a>
<a class="sourceLine" id="cb129-31" title="31"><span class="cf">for</span> (this.chem <span class="cf">in</span> human.hits<span class="op">$</span>CAS)</a>
<a class="sourceLine" id="cb129-32" title="32">{</a>
<a class="sourceLine" id="cb129-33" title="33">  med.conc &lt;-<span class="st"> </span><span class="kw">median</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">subset</span>(Tox21.acc.numeric,casn<span class="op">==</span>this.chem)<span class="op">$</span>value))</a>
<a class="sourceLine" id="cb129-34" title="34">  q10.conc &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">subset</span>(Tox21.acc.numeric,casn<span class="op">==</span>this.chem)<span class="op">$</span>value),<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb129-35" title="35">  low.conc &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">subset</span>(Tox21.acc.numeric,casn<span class="op">==</span>this.chem)<span class="op">$</span>value))</a>
<a class="sourceLine" id="cb129-36" title="36">  q90.conc &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">subset</span>(Tox21.acc.numeric,casn<span class="op">==</span>this.chem)<span class="op">$</span>value),<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb129-37" title="37">  high.conc &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="dv">10</span><span class="op">^</span>(<span class="kw">subset</span>(Tox21.acc.numeric,casn<span class="op">==</span>this.chem)<span class="op">$</span>value))</a>
<a class="sourceLine" id="cb129-38" title="38">  css95.v &lt;-<span class="st"> </span>human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem][[<span class="st">&quot;css95_v&quot;</span>]]</a>
<a class="sourceLine" id="cb129-39" title="39">  css95.uv &lt;-<span class="st"> </span>human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem][[<span class="st">&quot;css95_uv&quot;</span>]]</a>
<a class="sourceLine" id="cb129-40" title="40">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Median.ACC&quot;</span>] &lt;-<span class="st"> </span>med.conc</a>
<a class="sourceLine" id="cb129-41" title="41">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q10.ACC&quot;</span>] &lt;-<span class="st"> </span>q10.conc</a>
<a class="sourceLine" id="cb129-42" title="42">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q90.ACC&quot;</span>] &lt;-<span class="st"> </span>q90.conc</a>
<a class="sourceLine" id="cb129-43" title="43">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Low.ACC&quot;</span>] &lt;-<span class="st"> </span>low.conc</a>
<a class="sourceLine" id="cb129-44" title="44">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.High.ACC&quot;</span>] &lt;-<span class="st"> </span>high.conc</a>
<a class="sourceLine" id="cb129-45" title="45">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Median.equivdose.v&quot;</span>] &lt;-<span class="st"> </span>med.conc<span class="op">/</span>css95.v</a>
<a class="sourceLine" id="cb129-46" title="46">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q10.equivdose.v&quot;</span>] &lt;-<span class="st"> </span>q10.conc<span class="op">/</span>css95.v</a>
<a class="sourceLine" id="cb129-47" title="47">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q90.equivdose.v&quot;</span>] &lt;-<span class="st"> </span>q90.conc<span class="op">/</span>css95.v</a>
<a class="sourceLine" id="cb129-48" title="48">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Low.equivdose.v&quot;</span>] &lt;-<span class="st"> </span>low.conc<span class="op">/</span>css95.v</a>
<a class="sourceLine" id="cb129-49" title="49">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.High.equivdose.v&quot;</span>] &lt;-<span class="st"> </span>high.conc<span class="op">/</span>css95.v</a>
<a class="sourceLine" id="cb129-50" title="50">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Median.equivdose.uv&quot;</span>] &lt;-<span class="st"> </span>med.conc<span class="op">/</span>css95.uv</a>
<a class="sourceLine" id="cb129-51" title="51">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q10.equivdose.uv&quot;</span>] &lt;-<span class="st"> </span>q10.conc<span class="op">/</span>css95.uv</a>
<a class="sourceLine" id="cb129-52" title="52">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Q90.equivdose.uv&quot;</span>] &lt;-<span class="st"> </span>q90.conc<span class="op">/</span>css95.uv</a>
<a class="sourceLine" id="cb129-53" title="53">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.Low.equivdose.uv&quot;</span>] &lt;-<span class="st"> </span>low.conc<span class="op">/</span>css95.uv</a>
<a class="sourceLine" id="cb129-54" title="54">  human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;HTS.High.equivdose.uv&quot;</span>] &lt;-<span class="st"> </span>high.conc<span class="op">/</span>css95.uv</a>
<a class="sourceLine" id="cb129-55" title="55">}  </a>
<a class="sourceLine" id="cb129-56" title="56"></a>
<a class="sourceLine" id="cb129-57" title="57"></a>
<a class="sourceLine" id="cb129-58" title="58"></a>
<a class="sourceLine" id="cb129-59" title="59"><span class="co">#Add the exposure predictions:</span></a>
<a class="sourceLine" id="cb129-60" title="60"><span class="cf">for</span> (this.chem <span class="cf">in</span> human.hits<span class="op">$</span>CAS)</a>
<a class="sourceLine" id="cb129-61" title="61">{</a>
<a class="sourceLine" id="cb129-62" title="62">  <span class="kw">print</span>(this.chem)</a>
<a class="sourceLine" id="cb129-63" title="63"><span class="co"># If we have direct inferrences from NHANES, use those exposures:</span></a>
<a class="sourceLine" id="cb129-64" title="64">  <span class="cf">if</span> (this.chem <span class="op">%in%</span><span class="st"> </span>directnhanes.preds<span class="op">$</span>CASRN)</a>
<a class="sourceLine" id="cb129-65" title="65">  {</a>
<a class="sourceLine" id="cb129-66" title="66">    human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;Exposure.median&quot;</span>] &lt;-<span class="st"> </span>directnhanes.preds[directnhanes.preds<span class="op">$</span>CASRN<span class="op">==</span>this.chem,<span class="st">&quot;lP&quot;</span>]</a>
<a class="sourceLine" id="cb129-67" title="67">    human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;Exposure.high&quot;</span>] &lt;-<span class="st"> </span>directnhanes.preds[directnhanes.preds<span class="op">$</span>CASRN<span class="op">==</span>this.chem,<span class="st">&quot;lP.max&quot;</span>]</a>
<a class="sourceLine" id="cb129-68" title="68"><span class="co"># Otherwise use the heuristics model (Wambaugh 2014):    </span></a>
<a class="sourceLine" id="cb129-69" title="69">  } <span class="cf">else</span> <span class="cf">if</span> (this.chem <span class="op">%in%</span><span class="st"> </span>chem.preds<span class="op">$</span>CAS) {</a>
<a class="sourceLine" id="cb129-70" title="70">    human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;Exposure.median&quot;</span>] &lt;-<span class="st"> </span>chem.preds[chem.preds<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;seem3&quot;</span>]</a>
<a class="sourceLine" id="cb129-71" title="71">    human.hits[human.hits<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;Exposure.high&quot;</span>] &lt;-<span class="st"> </span>chem.preds[chem.preds<span class="op">$</span>CAS<span class="op">==</span>this.chem,<span class="st">&quot;seem3.u95&quot;</span>]  </a>
<a class="sourceLine" id="cb129-72" title="72">  }</a>
<a class="sourceLine" id="cb129-73" title="73">}</a>
<a class="sourceLine" id="cb129-74" title="74"></a>
<a class="sourceLine" id="cb129-75" title="75"><span class="co"># Drop chemicals without exposure predictions:</span></a>
<a class="sourceLine" id="cb129-76" title="76">human.hits&lt;-<span class="st"> </span><span class="kw">subset</span>(human.hits,<span class="op">!</span><span class="kw">is.na</span>(Exposure.median))</a>
<a class="sourceLine" id="cb129-77" title="77"></a>
<a class="sourceLine" id="cb129-78" title="78"></a>
<a class="sourceLine" id="cb129-79" title="79"><span class="co"># This code puts the chemicals into order by margine between exposure and activity:</span></a>
<a class="sourceLine" id="cb129-80" title="80">chem.names &lt;-<span class="st"> </span><span class="kw">unique</span>(human.hits<span class="op">$</span>Compound)</a>
<a class="sourceLine" id="cb129-81" title="81">potency &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">Inf</span>,<span class="dt">times=</span><span class="kw">length</span>(chem.names))</a>
<a class="sourceLine" id="cb129-82" title="82"><span class="kw">names</span>(potency) &lt;-<span class="st"> </span>chem.names</a>
<a class="sourceLine" id="cb129-83" title="83">potency.u &lt;-<span class="st"> </span>potency</a>
<a class="sourceLine" id="cb129-84" title="84"><span class="cf">for</span> (this.chem <span class="cf">in</span> chem.names)</a>
<a class="sourceLine" id="cb129-85" title="85">{</a>
<a class="sourceLine" id="cb129-86" title="86">  this.subset &lt;-<span class="st"> </span><span class="kw">subset</span>(human.hits,Compound<span class="op">==</span>this.chem)</a>
<a class="sourceLine" id="cb129-87" title="87">  potency[this.chem] &lt;-<span class="st"> </span>this.subset<span class="op">$</span>HTS.Q10.equivdose.v<span class="op">/</span>this.subset<span class="op">$</span>Exposure.high</a>
<a class="sourceLine" id="cb129-88" title="88">  potency.u[this.chem] &lt;-<span class="st"> </span>this.subset<span class="op">$</span>HTS.Q10.equivdose.uv<span class="op">/</span>this.subset<span class="op">$</span>Exposure.high</a>
<a class="sourceLine" id="cb129-89" title="89">}</a>
<a class="sourceLine" id="cb129-90" title="90">potency &lt;-<span class="st"> </span><span class="kw">sort</span>(potency)</a>
<a class="sourceLine" id="cb129-91" title="91">human.hits<span class="op">$</span>Compound &lt;-<span class="st"> </span><span class="kw">factor</span>(human.hits<span class="op">$</span>Compound, <span class="dt">levels=</span><span class="kw">names</span>(potency))</a>
<a class="sourceLine" id="cb129-92" title="92"></a>
<a class="sourceLine" id="cb129-93" title="93">potency.u &lt;-<span class="st"> </span>potency.u[<span class="kw">names</span>(potency.u)[potency.u<span class="op">&lt;</span><span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb129-94" title="94">potency.u &lt;-<span class="st"> </span>potency.u[<span class="kw">names</span>(potency)[potency<span class="op">&gt;</span><span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb129-95" title="95"></a>
<a class="sourceLine" id="cb129-96" title="96">new.overlaps &lt;-<span class="st"> </span><span class="kw">names</span>(potency.u[<span class="op">!</span><span class="kw">is.na</span>(potency.u)])</a>
<a class="sourceLine" id="cb129-97" title="97">first.change &lt;-<span class="st"> </span>new.overlaps[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb129-98" title="98">last.change &lt;-<span class="st"> </span>new.overlaps[<span class="kw">length</span>(new.overlaps)]</a>
<a class="sourceLine" id="cb129-99" title="99">window.start &lt;-<span class="st"> </span><span class="kw">names</span>(potency)[<span class="kw">which</span>(<span class="kw">names</span>(potency)<span class="op">==</span>first.change)<span class="op">-</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb129-100" title="100">window.end &lt;-<span class="st"> </span><span class="kw">names</span>(potency)[<span class="kw">which</span>(<span class="kw">names</span>(potency)<span class="op">==</span>last.change)<span class="op">+</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb129-101" title="101">window.names &lt;-<span class="st"> </span><span class="kw">names</span>(potency)[(<span class="kw">which</span>(<span class="kw">names</span>(potency)<span class="op">==</span>first.change)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span>(<span class="kw">which</span>(<span class="kw">names</span>(potency)<span class="op">==</span>last.change)<span class="op">+</span><span class="dv">5</span>)]</a>
<a class="sourceLine" id="cb129-102" title="102"><span class="co"># Initialize a new plot:</span></a>
<a class="sourceLine" id="cb129-103" title="103">Fig7a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>human.hits) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-104" title="104"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.v,<span class="dt">yend=</span>HTS.Q90.equivdose.v),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;white&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-105" title="105"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">xmin=</span>window.start,<span class="dt">xmax=</span>window.end,<span class="dt">ymin=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">9</span>,<span class="dt">ymax=</span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>),<span class="dt">color=</span><span class="st">&quot;grey&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb129-106" title="106"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.v,<span class="dt">yend=</span>HTS.Q90.equivdose.v),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-107" title="107"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>HTS.Median.equivdose.v),<span class="dt">shape=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-108" title="108"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.v)) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-109" title="109"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb129-110" title="110"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-111" title="111"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-112" title="112"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-113" title="113"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">9</span>,<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-114" title="114"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>Exposure.high,<span class="dt">yend=</span>Exposure.median),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-115" title="115"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>Exposure.median),<span class="dt">shape=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-116" title="116"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Bioactive Dose &amp; Exposure</span><span class="ch">\n</span><span class="st">mg/kg BW/day</span><span class="ch">\n</span><span class="st">(Variability Only)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-117" title="117"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Chemicals Ranked By Ratio Between Bioactive Dose and Exposure&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb129-118" title="118"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> <span class="kw">names</span>(potency)[<span class="dv">10</span>], <span class="dt">y =</span> <span class="dv">100</span>, <span class="dt">label =</span> <span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb129-119" title="119"></a>
<a class="sourceLine" id="cb129-120" title="120"><span class="co"># Initialize a new plot:</span></a>
<a class="sourceLine" id="cb129-121" title="121">Fig7c &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb129-122" title="122"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.v,<span class="dt">yend=</span>HTS.Q90.equivdose.v),<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-123" title="123"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.uv,<span class="dt">yend=</span>HTS.Q90.equivdose.uv),<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-124" title="124"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>HTS.Median.equivdose.uv),<span class="dt">shape=</span><span class="dv">3</span>,<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-125" title="125"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>HTS.Q10.equivdose.uv),<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-126" title="126"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb129-127" title="127"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">60</span>, <span class="dt">hjust =</span> <span class="dv">1</span>,<span class="dt">size=</span><span class="dv">6</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-128" title="128"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-129" title="129"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-130" title="130"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-131" title="131"><span class="st">  </span><span class="kw">xlim</span>(window.names) <span class="op">+</span></a>
<a class="sourceLine" id="cb129-132" title="132"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label=</span>scientific_<span class="dv">10</span>,<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>,<span class="dv">2</span><span class="op">*</span><span class="dv">10</span><span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-133" title="133"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span>Exposure.high,<span class="dt">yend=</span>Exposure.median),<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-134" title="134"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data=</span><span class="kw">subset</span>(human.hits,Compound<span class="op">%in%</span><span class="kw">names</span>(potency.u)),<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">xend=</span>Compound,<span class="dt">y=</span><span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>,<span class="dt">yend=</span>Exposure.median<span class="op">/</span><span class="fl">1.5</span>),<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">arrow=</span><span class="kw">arrow</span>(<span class="dt">length=</span><span class="kw">unit</span>(<span class="fl">0.5</span>,<span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></a>
<a class="sourceLine" id="cb129-135" title="135"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>human.hits,<span class="kw">aes</span>(<span class="dt">x=</span>Compound,<span class="dt">y=</span>Exposure.median),<span class="dt">shape=</span><span class="dv">2</span>,<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-136" title="136"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-137" title="137"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Bioactive Dose &amp; Exposure</span><span class="ch">\n</span><span class="st">mg/kg BW/day</span><span class="ch">\n</span><span class="st">(Uncertainty and Variability)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-138" title="138"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">size=</span><span class="dv">8</span>,<span class="dt">x =</span> window.names[<span class="dv">1</span>], <span class="dt">y =</span> <span class="dv">100</span>, <span class="dt">label =</span> <span class="st">&quot;b&quot;</span>)</a>
<a class="sourceLine" id="cb129-139" title="139"> </a>
<a class="sourceLine" id="cb129-140" title="140"></a>
<a class="sourceLine" id="cb129-141" title="141"><span class="co">#print(Fig10b)</span></a>
<a class="sourceLine" id="cb129-142" title="142"><span class="kw">dev.new</span>(<span class="dt">width=</span><span class="dv">10</span>,<span class="dt">height=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb129-143" title="143"><span class="kw">multiplot</span>(Fig7a,Fig7c,<span class="dt">cols=</span><span class="dv">1</span>,<span class="dt">heights=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb129-144" title="144"></a>
<a class="sourceLine" id="cb129-145" title="145"><span class="kw">write.csv</span>(<span class="kw">subset</span>(human.hits,Exposure.high<span class="op">&gt;</span>HTS.Q10.equivdose.uv)[,<span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;DSSTox_Substance_Id&quot;</span>,<span class="st">&quot;Human.Clint&quot;</span>,<span class="st">&quot;Human.Funbound.plasma&quot;</span>,<span class="st">&quot;HTS.Q10.ACC&quot;</span>,<span class="st">&quot;HTS.Q10.equivdose.v&quot;</span>,<span class="st">&quot;HTS.Q10.equivdose.uv&quot;</span>,<span class="st">&quot;Exposure.high&quot;</span>)],<span class="dt">file=</span><span class="kw">paste</span>(<span class="st">&quot;SupTable5-&quot;</span>,<span class="kw">Sys.Date</span>(),<span class="st">&quot;.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">row.names=</span>F)</a></code></pre></div>
<p>#Final statistics:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">Wetmore.chems &lt;-<span class="st"> </span><span class="kw">subset</span>(chem.physical_and_invitro.data,<span class="kw">regexpr</span>(<span class="st">&quot;Wetmore&quot;</span>,Human.Clint.Reference)<span class="op">!=-</span><span class="dv">1</span>)[,<span class="kw">c</span>(<span class="st">&quot;Compound&quot;</span>,<span class="st">&quot;CAS&quot;</span>,<span class="st">&quot;DTXSID&quot;</span>,<span class="st">&quot;Formula&quot;</span>)]</a>
<a class="sourceLine" id="cb130-2" title="2">Wetmore.chems &lt;-<span class="st"> </span><span class="kw">subset</span>(Wetmore.chems,CAS<span class="op">%in%</span><span class="kw">get_cheminfo</span>())</a>
<a class="sourceLine" id="cb130-3" title="3"></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="cf">for</span> (this.cas <span class="cf">in</span> Wetmore.chems<span class="op">$</span>CAS)</a>
<a class="sourceLine" id="cb130-5" title="5">{</a>
<a class="sourceLine" id="cb130-6" title="6">  Wetmore.chems[Wetmore.chems<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Css.Lit&quot;</span>] &lt;-<span class="st"> </span><span class="kw">get_lit_css</span>(</a>
<a class="sourceLine" id="cb130-7" title="7">    <span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb130-8" title="8">    <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>)</a>
<a class="sourceLine" id="cb130-9" title="9">  <span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb130-10" title="10">  Wetmore.chems[Wetmore.chems<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Css.v192&quot;</span>] &lt;-<span class="st"> </span><span class="kw">calc_mc_css</span>(</a>
<a class="sourceLine" id="cb130-11" title="11">    <span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb130-12" title="12">    <span class="dt">fup.meas.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb130-13" title="13">    <span class="dt">clint.meas.cv=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb130-14" title="14">    <span class="dt">fup.censored.dist=</span>T,</a>
<a class="sourceLine" id="cb130-15" title="15">    <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>)</a>
<a class="sourceLine" id="cb130-16" title="16">  <span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb130-17" title="17">  Wetmore.chems[Wetmore.chems<span class="op">$</span>CAS<span class="op">==</span>this.cas,<span class="st">&quot;Css.v110&quot;</span>] &lt;-<span class="st"> </span><span class="kw">calc_mc_css</span>(</a>
<a class="sourceLine" id="cb130-18" title="18">    <span class="dt">chem.cas=</span>this.cas,</a>
<a class="sourceLine" id="cb130-19" title="19">    <span class="dt">output.units=</span><span class="st">&quot;uM&quot;</span>)</a>
<a class="sourceLine" id="cb130-20" title="20">}</a>
<a class="sourceLine" id="cb130-21" title="21"></a>
<a class="sourceLine" id="cb130-22" title="22"><span class="kw">median</span>(Wetmore.chems<span class="op">$</span>Css.v110<span class="op">/</span>Wetmore.chems<span class="op">$</span>Css.Lit,<span class="dt">na.rm=</span>T)</a>
<a class="sourceLine" id="cb130-23" title="23"></a>
<a class="sourceLine" id="cb130-24" title="24">ceetox<span class="op">$</span>Human.Clint2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ceetox<span class="op">$</span>Human.Clint,<span class="cf">function</span>(x) <span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb130-25" title="25">ceetox<span class="op">$</span>Human.Fup2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ceetox<span class="op">$</span>Human.Funbound.plasma,<span class="cf">function</span>(x) <span class="kw">as.numeric</span>(<span class="kw">strsplit</span>(x,<span class="st">&quot;,&quot;</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb130-26" title="26"><span class="kw">write.csv</span>(ceetox[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">15</span>,<span class="dv">31</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">18</span><span class="op">:</span><span class="dv">28</span>)],<span class="dt">row.names=</span>F,<span class="dt">file=</span><span class="kw">paste</span>(<span class="st">&quot;Supplemental-Table4-&quot;</span>,<span class="kw">Sys.Date</span>(),<span class="st">&quot;.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb130-27" title="27"></a>
<a class="sourceLine" id="cb130-28" title="28"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Complete HTTK data on&quot;</span>,<span class="kw">sum</span>(<span class="kw">get_cheminfo</span>()<span class="op">%in%</span>ceetox<span class="op">$</span>CAS),<span class="st">&quot;new chemicals.&quot;</span>))</a></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
